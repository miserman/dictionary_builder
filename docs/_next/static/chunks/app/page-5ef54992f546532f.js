(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{46919:function(e,t,n){Promise.resolve().then(n.bind(n,15236))},15236:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return nj}});var s=n(57437),r=n(98595),a=n(33948),i=n(3857),l=n(2265),o=n(48123),c=n(60502),d=n(13457),h=n(43226),u=n(35266),m=n(69299),x=n(8864),p=n(6882);let y=/[\r\n]+/,g=/\*/,j=/\*/g,f=/([\[\]\(\)*?^$.+])/g,Z=/^;|;$/g,b=/([\[\]\(\)?^$.+])/g;function v(e){return";"+e.replace(b,"\\$&").replace(j,"[^;]*")+";"}function C(e,t){return e.length-t.length}function _(e,t){return t&&-1!==e?(1-e/t)*100:0}let w=/\./g;function k(e){return";"+e.replace(w,"[^;]")+";"}let S=/^.*[/\\]/;function E(e){return e.replace(S,"")}let z=(0,l.createContext)({}),O=[{key:"terms",label:"Terms"},{key:"termAssociations",label:"Term Associations"},{key:"sense_keys",label:"Sense Keys"},{key:"synsetInfo",label:"Synset Info"}];function N(e){let{children:t}=e,[n,r]=(0,l.useState)(),[a,i]=(0,l.useState)(),[g,j]=(0,l.useState)(),[f,Z]=(0,l.useState)(),[b,v]=(0,l.useState)(),[C,_]=(0,l.useState)(),[w,k]=(0,l.useState)(),[S,E]=(0,l.useState)(!0),[N,P]=(0,l.useState)(!0),[F,A]=(0,l.useState)(!0),[M,T]=(0,l.useState)(!0);(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/terms.txt").then(e=>e.text()).then(e=>{let t=Object.freeze(e.split(y));r(t);let n={all:";;"+t.join(";;")+";;"},s={};t.forEach((e,t)=>{s[e]=t;let r=e[0];r&&(r in n?n[r]+=e+";;":n[r]=";;"+e+";;")}),j(Object.freeze(s)),Z(Object.freeze(n))}).finally(()=>E(!1))},[E]),(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/term_associations.json").then(e=>e.json()).then(e=>{v(e)}).finally(()=>P(!1))},[P]),(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/sense_keys.txt").then(e=>e.text()).then(e=>{_(Object.freeze(e.split(y)))}).finally(()=>A(!1))},[A]),(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/synset_info.json").then(e=>e.json()).then(e=>{k(e.map((e,t)=>(e.index=t,e)))}).finally(()=>T(!1))},[T]),(0,l.useEffect)(()=>{if(n&&b){let e={};b.forEach((t,s)=>{if(t.length){let r=t[0],a="number"==typeof r?r:r.length?r[0]:0;if(a){let t=n[s],r=n[a-1],i=e[r];i&&"function"!=typeof i?"number"==typeof i?e[r]=[a-1,i,s]:i.push(s):e[r]=[a-1,s],e[t]=a-1}}}),i(e)}},[n,b]);let W=(0,l.useMemo)(()=>({terms:n,lemmas:a,termLookup:g,collapsedTerms:f,termAssociations:b,sense_keys:C,synsetInfo:w}),[n,a,g,f,b,C,w]),D={terms:S,termAssociations:N,sense_keys:F,synsetInfo:M};return(0,s.jsx)(z.Provider,{value:W,children:a&&w?t:(0,s.jsxs)(d.Z,{sx:{margin:"auto",marginTop:10,maxWidth:350},children:[(0,s.jsx)(h.Z,{variant:"h4",children:"Loading Resources..."}),(0,s.jsx)(u.Z,{children:O.map(e=>{let{key:t,label:n}=e;return(0,s.jsxs)(m.ZP,{dense:!0,children:[(0,s.jsx)(x.Z,{sx:{minWidth:"35px",mb:1},children:W[t]?(0,s.jsx)(o.Z,{color:"success"}):D[t]?(0,s.jsx)(p.Z,{size:"1.5rem"}):(0,s.jsx)(c.Z,{color:"error",sx:{marginBottom:-.8}})}),(0,s.jsxs)(h.Z,{children:[W[t]||D[t]?"":"Failed to load ",n]})]},t)})})]})})}var P=n(68457),F=n(14262),A=n(52653),M=n(64111),T=n(15133),W=n(26114),D=n(88469),R=n(40182),I=n(88444),L=n(21975),K=n(88956),q=n(49050),B=n(89394),H=n(91797),U=n(26337),G=n(42834);function J(e){let{label:t,message:n,onConfirm:r}=e,[a,i]=(0,l.useState)(!1),o=()=>i(!a);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.Z,{fullWidth:!0,color:"error",onClick:o,children:t}),a&&(0,s.jsxs)(B.Z,{open:a,onClose:o,children:[(0,s.jsx)(H.Z,{children:"Confirm"}),(0,s.jsx)(A.Z,{"aria-label":"close export menu",onClick:o,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsx)(U.Z,{children:(0,s.jsx)(h.Z,{children:n})}),(0,s.jsxs)(G.Z,{sx:{justifyContent:"space-between"},children:[(0,s.jsx)(q.Z,{onClick:o,children:"Cancel"}),(0,s.jsx)(q.Z,{variant:"contained",color:"error",onClick:()=>{r(),o()},children:t})]})]})]})}let V={},$=new TextEncoder;async function Y(e,t,n){if(!(e in V)){let s=await crypto.subtle.importKey("raw",$.encode(t),{name:"PBKDF2"},!1,["deriveKey"]);V[e]={salt:n,key:await crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e6,hash:"SHA-256"},s,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}}return V[e]}async function X(e,t,n){let s=n?await Y(e,n,crypto.getRandomValues(new Uint8Array(16))):V[e],r=crypto.getRandomValues(new Uint8Array(12));if(s)try{let e=new Blob([JSON.stringify(t)]).stream().pipeThrough(new CompressionStream("gzip")).getReader(),n=[];for(;;){let{done:t,value:s}=await e.read();if(t)break;n.push(s)}let a=new Uint8Array(await new Blob(n).arrayBuffer()),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},s.key,a);return r.toString()+","+s.salt.toString()+","+new Uint8Array(i).toString()}catch(t){console.error("failed to encrypt "+e)}}async function Q(e,t,n){let s=Uint8Array.from(t.split(",").map(e=>+e)).buffer,r=n?await Y(e,n,new Uint8Array(s,12,16)):V[e];if(r)try{let e=await crypto.subtle.decrypt({name:"AES-GCM",iv:new Uint8Array(s,0,12)},r.key,new Uint8Array(s,28)),t=new Blob([e]).stream().pipeThrough(new DecompressionStream("gzip"));return new Response(t).json()}catch(e){}}async function ee(e,t,n){delete V[e],n||localStorage.removeItem(t+e)}async function et(e,t,n,s,r){let a=r||e in V?await X(e,n,r):JSON.stringify(n);if(a)try{s||localStorage.setItem(t+e,a)}catch(t){console.error("failed to store "+e)}}async function en(e,t,n,s,r,a){let i=localStorage.getItem(t+e);if(i){if("{"===i[0])n(JSON.parse(i));else{if(!(e in V)){r(e,()=>async t=>{let s=await Q(e,i,t);if(s)n(s);else throw delete V[e],Error});return}n(await Q(e,i))}}else a&&n(a)}let es={};async function er(e,t,n,s){en(e,"dict_history_",e=>{e&&t(e)},s,n,{edits:[],position:-1})}async function ea(e,t,n,s){e in es?t(es[e]):en(e,"dict_",n=>{n&&(es[e]=n,t(n))},s,n)}let ei="30vh",el="200px";function eo(){let e=(0,l.useContext)(ey),t=(0,l.useContext)(ep),[n,r]=(0,l.useState)(!1),a=()=>r(!n),i=(0,l.useContext)(e_),[o,c]=(0,l.useState)(t.undo||"z"),[u,m]=(0,l.useState)(t.redo||"x"),[x,p]=(0,l.useState)(!!t.disable_storage),y=(0,l.useCallback)(e=>{!e.ctrlKey&&!e.metaKey||e.target&&"tagName"in e.target&&"INPUT"===e.target.tagName||(e.key===u?i(-1):e.key===o&&i(1))},[o,u,i]);return(0,l.useEffect)(()=>(window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}),[y]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.Z,{onClick:a,"aria-label":"toggle settings menu",children:(0,s.jsx)(P.Z,{})}),(0,s.jsx)(M.ZP,{anchor:"right",open:n,onClose:a,children:(0,s.jsxs)(T.Z,{sx:{height:"100%",width:"12em",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,s.jsx)(W.Z,{title:(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Settings"}),action:(0,s.jsx)(A.Z,{onClick:a,"aria-label":"close settings menu",className:"close-button",children:(0,s.jsx)(F.Z,{})})}),(0,s.jsx)(D.Z,{sx:{alignContent:"left",mb:"auto"},children:(0,s.jsxs)(d.Z,{spacing:2,children:[(0,s.jsx)(R.Z,{label:"Disable Storage",labelPlacement:"start",sx:{justifyContent:"space-between"},control:(0,s.jsx)(I.Z,{checked:x,size:"small",onChange:n=>{t.disable_storage=!x,e({...t}),localStorage.setItem("dictionary_builder_settings",JSON.stringify(t)),p(!x)}})}),(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Keybinds"}),(0,s.jsx)(h.Z,{variant:"caption",children:"CTRL + "}),(0,s.jsxs)(d.Z,{spacing:2,sx:{mt:1},children:[(0,s.jsx)(L.Z,{size:"small",label:"undo",value:o,onChange:n=>{window.removeEventListener("keydown",y),t.undo=n.target.value,e({...t}),localStorage.setItem("dictionary_builder_settings",JSON.stringify(t)),c(n.target.value)}}),(0,s.jsx)(L.Z,{size:"small",label:"redo",value:u,onChange:n=>{window.removeEventListener("keydown",y),t.redo=n.target.value,e({...t}),localStorage.setItem("dictionary_builder_settings",JSON.stringify(t)),m(n.target.value)}})]})]})}),(0,s.jsx)(K.Z,{children:(0,s.jsx)(J,{label:"Clear Storage",message:"Clearing storage will delete all settings, dictionaries, and edit history.",onConfirm:()=>{t.dictionary_names&&t.dictionary_names.forEach(e=>{ee(e,"dict_",!!t.use_db),ee(e,"dict_history_",!!t.use_db)}),localStorage.removeItem("dictionary_builder_settings"),window.location.reload()}})})]})})]})}var ec=n(72502),ed=n(38212),eh=n(7154),eu=n(19093),em=n(39657);function ex(){let e=(0,l.useContext)(ev),t=(0,l.useContext)(eC),n=(0,l.useContext)(e_),r=(0,l.useMemo)(()=>e.edits.map((t,r)=>(0,s.jsx)(m.ZP,{sx:{p:0},children:(0,s.jsx)(ec.Z,{sx:{borderLeft:e.position>=r?"2px solid #fff":""},onClick:()=>n(r-e.position),children:(0,s.jsx)(ed.Z,{sx:{m:0},primary:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h.Z,{children:[(0,s.jsx)("span",{style:{opacity:".75"},children:t.type+": "}),t.name]}),"edit_term"===t.type?(0,s.jsx)(h.Z,{className:"code",sx:{wordBreak:"break-all"},children:"categories"===t.value.field?t.value.edits.map(e=>e.category+": "+e.from+" -> "+e.to).join("\n"):t.value.field+": "+t.value.original+" -> "+t.value.new}):"rename_category"===t.type?(0,s.jsxs)(h.Z,{className:"code",children:["From ",t.originalName]}):(0,s.jsx)(s.Fragment,{})]}),secondary:(0,s.jsx)(h.Z,{sx:{fontSize:".8em",opacity:.6},variant:"body2",children:t.time?new Date(t.time).toLocaleString():""})})})},r)),[e,n]);return(0,s.jsxs)(T.Z,{elevation:5,sx:{height:"60%",minHeight:"300px",position:"relative",display:"flex",flexDirection:"column"},children:[(0,s.jsx)(W.Z,{title:(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Edit History"}),sx:{pb:0}}),(0,s.jsxs)(d.Z,{direction:"row",sx:{position:"absolute",top:8,right:8},children:[(0,s.jsx)(A.Z,{onClick:()=>n(1),"aria-label":"undo",children:(0,s.jsx)(eh.Z,{})}),(0,s.jsx)(A.Z,{onClick:()=>n(-1),"aria-label":"redo",children:(0,s.jsx)(eu.Z,{})}),(0,s.jsx)(A.Z,{onClick:()=>n(-1e3),"aria-label":"jump to current",children:(0,s.jsx)(em.Z,{})})]}),(0,s.jsx)(D.Z,{sx:{p:0,mb:"auto",overflowY:"auto"},children:(0,s.jsx)(u.Z,{sx:{overflowX:"hidden"},children:r})}),(0,s.jsx)(K.Z,{children:(0,s.jsx)(q.Z,{fullWidth:!0,onClick:()=>{t({type:"clear"})},children:"Clear"})})]})}let ep=(0,l.createContext)({selected:"default",dictionary_names:["default"]}),ey=(0,l.createContext)(e=>{}),eg=(0,l.createContext)(e=>{}),ej=(0,l.createContext)({}),ef=(0,l.createContext)(e=>{}),eZ=(0,l.createContext)([]),eb=(0,l.createContext)(e=>{}),ev=(0,l.createContext)({edits:[],position:-1}),eC=(0,l.createContext)(e=>{}),e_=(0,l.createContext)(e=>{}),ew=(0,l.createContext)(""),ek=()=>async e=>{},eS=(0,l.createContext)((e,t)=>{}),eE=(0,l.createContext)(async e=>{});function ez(e,t){return e.toLowerCase()>t.toLowerCase()?1:-1}function eO(e){let{children:t}=e,[n,r]=(0,l.useState)(""),[a,i]=(0,l.useState)(ek),o=(e,t)=>{t?(r(e),i(t)):(r(""),i(ek))},[c,d]=(0,l.useState)(function(){let e=JSON.parse(localStorage.getItem("dictionary_builder_settings")||"{}");return e.dictionary_names||(e.dictionary_names=["default"]),e.selected&&e.dictionary_names.includes(e.selected)||(e.selected="default"),e}()),h=!!c.use_db,u=e=>{ea(e,t=>{Z({type:"change_dict",name:e,dict:t})},o,h)},m=e=>{if("replace"===e.type){p(e.history);return}let t="clear"===e.type?[]:[...x.edits],n="clear"===e.type?-1:x.position;"remove"===e.type?t.pop():"clear"!==e.type&&(n>-1&&(t.splice(0,n+1),n=-1),e.entry.time||(e.entry.time=Date.now()),t.splice(0,0,e.entry)),t.length>1e3&&t.splice(1e3,t.length-999),c.disable_storage||et(c.selected,"dict_history_",{edits:t,position:n},h),p({edits:t,position:n})},[x,p]=(0,l.useState)({edits:[],position:-1}),y=e=>{"delete"===e.type?("default"!==e.name&&c.dictionary_names.splice(c.dictionary_names.indexOf(e.name),1),c.selected="default",d({...c}),ee(e.name,"dict_",h),ee(e.name,"dict_history_",h),u("default")):(c.dictionary_names.includes(e.name)||c.dictionary_names.push(e.name),c.selected=e.name,"set"===e.type?u(e.name):(c.disable_storage||et(e.name,"dict_",e.dict,h,e.password),"add"===e.type&&Z({type:"change_dict",name:e.name,dict:e.dict}))),et("dictionary_builder_settings","",c,h)},[g,j]=(0,l.useReducer)((e,t)=>{let n=e;if("collect"===t.type){let s=new Set(t.reset?[]:e);Object.keys(t.dictionary).forEach(e=>{let n=t.dictionary[e];n&&n.categories&&Object.keys(n.categories).forEach(e=>s.add(e))}),n=Array.from(s).sort(ez)}else"add"===t.type?e.includes(t.cat)||(n=[...e,t.cat].sort(ez)):n=e.filter(e=>e!==t.cat);return e.length!==n.length||e.join("")!==n.join("")?n:e},[]),[f,Z]=(0,l.useReducer)((e,t)=>{if("history_bulk"===t.type)return j({type:"collect",dictionary:t.dict,reset:!0}),y({type:"save",name:c.selected,dict:t.dict}),t.dict;if("change_dict"===t.type)return er(t.name,e=>m({type:"replace",history:e}),o,h),j({type:"collect",dictionary:t.dict,reset:!0}),t.dict;let n={...e};if("rename_category"===t.type){let e=0;Object.keys(n).forEach(s=>{let r=n[s];t.name in r.categories&&(e++,r.categories[t.name]&&(r.categories[t.newName]=r.categories[t.name]),delete r.categories[t.name])}),j({type:"remove",cat:t.name}),j({type:"add",cat:t.newName}),e&&m({type:"add",entry:{type:"rename_category",name:t.newName,originalName:t.name}})}else if("remove_category"===t.type){let e={},s=0;Object.keys(n).forEach(r=>{let a=n[r];t.name in a.categories&&(s++,a.categories[t.name]&&(e[r]=a.categories[t.name]),delete a.categories[t.name])}),s&&m({type:"add",entry:{type:"remove_category",name:t.name,weights:e}})}else if("add_category"===t.type)Object.keys(t.weights).forEach(e=>{e in n&&(t.weights[e]?n[e].categories[t.name]=t.weights[e]:delete n[e].categories[t.name])}),m({type:"add",entry:t});else if("reweight_category"===t.type){let e={},s=0;Object.keys(n).forEach(r=>{let a=n[r];a.categories[t.name]!==t.weights[r]&&(s++,e[r]=a.categories[t.name]||0,t.weights[r]?a.categories[t.name]=t.weights[r]:delete a.categories[t.name])}),s&&m({type:"add",entry:{...t,originalWeights:e}})}else{let s="string"==typeof t.term?t.term:t.term.source;if("remove"===t.type)delete n[s],m({type:"add",entry:{type:"remove_term",name:s,value:e[s]}});else{let r=n[s]||{};if(n[s]={added:r.added||Date.now(),type:t.term_type||r.type||"fixed",categories:{...t.categories||r.categories||{}},sense:"sense"in t?t.sense||"":r.sense||""},"replace"===t.type){let r="string"==typeof t.originalTerm?t.originalTerm:t.originalTerm.source;delete n[r],m({type:"add",entry:{type:"replace_term",name:s,value:n[s],originalName:r,originalValue:e[r]}})}else if(s in e){let t;let r=e[s],a=n[s];if(r.sense&&a.sense!==r.sense)t={field:"sense",new:a.sense,original:r.sense};else{let e=[];Object.keys(a.categories).forEach(t=>{a.categories[t]!==r.categories[t]&&e.push({category:t,from:r.categories[t]||0,to:a.categories[t]||0})}),Object.keys(r.categories).forEach(t=>{t in a.categories||e.push({category:t,from:r.categories[t],to:0})}),e.length?t={field:"categories",edits:e}:a.sense!==r.sense&&(t={field:"sense",new:a.sense,original:r.sense})}t&&m({type:"add",entry:{type:"edit_term",name:s,value:t}})}else m({type:"add",entry:{type:"add_term",name:s,value:n[s]}})}j({type:"collect",dictionary:n})}return y({type:"save",name:c.selected,dict:n}),n},{});return(0,l.useEffect)(()=>{c.dictionary_names.includes(c.selected)||(c.selected="default"),u(c.selected)},[]),(0,s.jsx)(ep.Provider,{value:c,children:(0,s.jsx)(ey.Provider,{value:d,children:(0,s.jsx)(ew.Provider,{value:n,children:(0,s.jsx)(eS.Provider,{value:o,children:(0,s.jsx)(eE.Provider,{value:a,children:(0,s.jsx)(ev.Provider,{value:x,children:(0,s.jsx)(eC.Provider,{value:m,children:(0,s.jsx)(eg.Provider,{value:y,children:(0,s.jsx)(ej.Provider,{value:f,children:(0,s.jsx)(eZ.Provider,{value:g,children:(0,s.jsx)(ef.Provider,{value:Z,children:(0,s.jsx)(eb.Provider,{value:j,children:(0,s.jsx)(e_.Provider,{value:e=>{let t=Math.min(Math.max(-1,x.position+e),x.edits.length-1);if(t!==x.position){let e={...f},n={...x};(function(e,t,n){let s=t.position;if(e>t.position)for(s=Math.max(0,s);s<e+1;s++)t.edits[s]&&function(e,t){switch(e.type){case"add_term":delete t[e.name];return;case"remove_term":t[e.name]=e.value;return;case"replace_term":delete t[e.name],t[e.originalName]=e.originalValue;return;case"edit_term":if("categories"===e.value.field){let n={...t[e.name]};e.value.edits.forEach(e=>{e.from?n.categories[e.category]=e.from:delete n.categories[e.category]})}else t[e.name][e.value.field]=e.value.original;return;case"add_category":Object.keys(t).forEach(n=>{let s=t[n];Object.keys(s.categories).forEach(t=>{t in e.weights&&delete s.categories[t]})});return;case"remove_category":Object.keys(t).forEach(n=>{n in e.weights&&(t[n].categories[e.name]=e.weights[n])});return;case"reweight_category":Object.keys(t).forEach(n=>{e.originalWeights[n]?t[n].categories[e.name]=e.originalWeights[n]:delete t[n].categories[e.name]});return;case"rename_category":Object.keys(t).forEach(n=>{let s=t[n];e.name in s.categories&&(s.categories[e.name]&&(s.categories[e.originalName]=s.categories[e.name]),delete s.categories[e.name])});return}}(t.edits[s],n);else for(s=Math.min(t.edits.length-1,s);s>e;s--)t.edits[s]&&function(e,t){switch(e.type){case"add_term":t[e.name]=e.value;return;case"remove_term":delete t[e.name];return;case"replace_term":delete t[e.originalName],t[e.name]=e.value;return;case"edit_term":if("categories"===e.value.field){let n={...t[e.name]};e.value.edits.forEach(e=>{e.to?n.categories[e.category]=e.to:delete n.categories[e.category]})}else t[e.name][e.value.field]=e.value.new;return;case"add_category":Object.keys(t).forEach(n=>{n in e.weights&&(t[n].categories[e.name]=e.weights[n])});return;case"remove_category":Object.keys(t).forEach(n=>{let s=t[n];s&&s.categories&&e.name in s.categories&&delete s.categories[e.name]});return;case"reweight_category":Object.keys(t).forEach(n=>{e.weights[n]?t[n].categories[e.name]=e.weights[n]:delete t[n].categories[e.name]});return;case"rename_category":Object.keys(t).forEach(n=>{let s=t[n];e.originalName in s.categories&&(s.categories[e.originalName]&&(s.categories[e.name]=s.categories[e.originalName]),delete s.categories[e.originalName])});return}}(t.edits[s],n);t.position=e})(t,n,e),m({type:"replace",history:n}),et(c.selected,"dict_history_",n,h),Z({type:"history_bulk",dict:e})}},children:t})})})})})})})})})})})})})}var eN=n(38639),eP=n(74309),eF=n(78276),eA=n(30666),eM=n(79245),eT=n(15795),eW=n(73701),eD=n(66988),eR=n(98489),eI=n(39279),eL=n(27449),eK=n(25210);function eq(e){let{senseKey:t,info:n}=e,r=(0,l.useContext)(tH);return(0,s.jsx)(eF.Z,{title:n.definition,placement:"right",children:(0,s.jsx)(eK.Z,{underline:"none",sx:{p:0,justifyContent:"flex-start",cursor:"pointer",display:"block"},onClick:()=>r({type:"add",state:{type:"synset",value:t,info:n}}),children:t})})}function eB(e,t){return Array.isArray(e)?e.map(e=>t[e-1]):[t[e-1]]}function eH(e,t,n){let s=new Set(eB(e.members,t));return Object.keys(e).forEach(r=>{if("members"!==r&&"index"!==r){var a;(Array.isArray(a=e[r])?"number"==typeof a[0]?a.map(e=>n[e-1]):[]:"number"==typeof a?[n[a-1]]:[]).forEach(e=>{eB(e.members,t).forEach(e=>s.add(e))})}}),Array.from(s)}function eU(e){let{name:t,info:n}=e,r=n[t],a=(0,l.useContext)(ej),i=(0,l.useContext)(ef),o=(0,l.useContext)(tH),{terms:c,sense_keys:d,synsetInfo:m}=(0,l.useContext)(z);return c&&d&&m?(0,s.jsxs)(eM.Z,{sx:{m:1},children:[(0,s.jsx)(h.Z,{variant:"h5",children:t}),(0,s.jsx)(u.Z,{children:"string"==typeof r?r:"members"===t?c?Array.isArray(r)?r.map(e=>tI(c[e-1],a,i,o)):tI(c[r-1],a,i,o):(0,s.jsx)(s.Fragment,{}):Array.isArray(r)?r.map(e=>{let t=m[e-1];return(0,s.jsx)(eq,{senseKey:d[e-1],info:t},e)}):(0,s.jsx)(eq,{senseKey:d[r-1],info:m[r-1]})})]},t):(0,s.jsx)(s.Fragment,{})}let eG={id:0,index:0,ili:0,definition:0,topic:0},eJ={a:"adj",r:"adv",s:"adj",n:"noun",v:"verb"};function eV(e){let{info:t}=e,{sense_keys:n}=(0,l.useContext)(z);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{variant:"h6",children:t.definition}),(0,s.jsxs)(d.Z,{direction:"row",spacing:2,children:[(0,s.jsxs)(eM.Z,{children:[(0,s.jsxs)(h.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Open English WordNet ID: ",(0,s.jsx)("span",{className:"number",children:t.id})]}),(0,s.jsxs)(h.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Sense Key: ",(0,s.jsx)("span",{className:"number",children:n&&n[t.index]})]}),(0,s.jsxs)(h.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Interlingual ID: ",(0,s.jsx)("span",{className:"number",children:t.ili})]})]}),(0,s.jsxs)(eM.Z,{children:[(0,s.jsxs)(h.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Part of Speech:"," ",(0,s.jsx)("span",{className:"number",children:eJ[t.id.substring(t.id.length-1)]})]}),(0,s.jsxs)(h.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Topic: ",(0,s.jsx)("span",{className:"number",children:t.topic})]})]})]}),(0,s.jsx)(d.Z,{direction:"row",sx:{mt:2},children:Object.keys(t).filter(e=>!(e in eG)).map(e=>(0,s.jsx)(eU,{name:e,info:t},e))})]})}let e$=/[aeiouy]$/;function eY(e,t){let n,s;let r=new Set,a=(e=e.replace(f,"\\$&")).length;try{n=a>3?RegExp(";(?:anti|de|dis|central|en|ex|faux|hyper|il|ill|in|intra|inter|ir|meso|mal|mid|middle|mis|miss|non|over|pan|post|pre|pro|re|retro|sudo|sub|super|un|uber|under|ultra|trans)?-?"+e+(e$.test(e)?"*":"+")+"-?(?:'|ac|age|al|alize|ance|ancy|ant|ary|at|ate|ation|cracy|cy|cycle|d|dom|ed|ence|ency|ent|er|es|esque|est|ette|ey|ful|hood|ial|ic|ie|ies|ify|in|ing|ion|ionate|isation|ish|ise|ism|ist|ive|ize|ization|let|lets|lette|like|ling|lings|log|ly|ley|ment|n|nce|ness|ng|nt|or|on|ous|r|s|ship|st|t|th|ties|ty|ur|ward|wise|y|z)?(?:'|al|alize|alization|ate|ation|ble|d|ed|er|es|ility|in|ing|ion|ise|isation|ish|ize|ization|ly|ness|ous|s|y|z)?;","g"):RegExp(";(?:de|un|re)?-?"+(a>2?e.replace(e$,"[aeiouy]"):e)+"+-?(?:'|d|ed|er|en|ing|s|y)?;","g")}catch(e){}if(n)for(;s=n.exec(t);){let t=s[0];t&&t.length-1>a&&";"+e+";"!==t&&r.add(t.replace(Z,""))}return Array.from(r)}var eX=n(39350),eQ=n(40471),e0=n(1664),e1=n(8076),e2=n(22750),e3=n(71932),e5=n(47827),e8=n(34989),e4=n(83509),e6=n(7662),e9=n(56470),e7=n(53050),te=n(12016),tt=n(36350),tn=n(28362),ts=n(84081),tr=n(2510);let ta=(0,l.createContext)(""),ti=(0,l.createContext)((e,t)=>{});function tl(e){let{categories:t,editor:n}=e,r=(0,l.useContext)(z),a=(0,l.useContext)(ej),i=(0,l.useContext)(ta),o=(0,l.useContext)(ti),[c,u]=(0,l.useState)(!1);if(!i||!(i in a))return(0,s.jsx)(s.Fragment,{});let m=tw(i,r,a),x=a[i],p=(0,l.useMemo)(()=>[{field:"id",headerName:"Name",width:110},{field:"from_term_editor",headerName:"Weight",width:65,editable:!0,hideable:!1,valueParser:(e,t)=>{let s=+e||"";return t&&n(s,t),s}}],[]),y=x.categories,g=[];return t.forEach(e=>{(c||e in y)&&g.push({id:e,from_term_editor:y[e]||"",dictEntry:x,processed:m})}),(0,s.jsx)(eM.Z,{sx:{position:"absolute",top:0,right:"-"+el,height:"100%",width:el},children:(0,s.jsxs)(T.Z,{sx:{height:"100%",pb:"2.5em"},elevation:1,children:[(0,s.jsx)(W.Z,{action:(0,s.jsx)(A.Z,{"aria-label":"Close term editor",onClick:()=>o(""),className:"close-button",children:(0,s.jsx)(F.Z,{})}),title:(0,s.jsx)(h.Z,{fontWeight:"bold",sx:{whiteSpace:"nowrap"},children:(0,s.jsx)(tK,{term:m.term})})}),(0,s.jsx)(D.Z,{sx:{p:.5,height:"100%"},children:(0,s.jsxs)(d.Z,{direction:"column",sx:{height:"100%"},children:[(0,s.jsxs)(ts.Z,{sx:{mb:3},children:["fuzzy"!==m.type&&m.synsets.length?(0,s.jsx)(tr.Z,{sx:{mt:x.sense?"":"-7px"},id:"term_editor_sense",children:"Sense"}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(tM,{labelId:"term_editor_sense",label:"Sense",id:"",field:"",processed:m})]}),(0,s.jsxs)(d.Z,{direction:"column",spacing:1,sx:{height:"100%"},children:[(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Category Weights"}),(0,s.jsx)(R.Z,{control:(0,s.jsx)(I.Z,{size:"small",checked:c,onChange:()=>u(!c)}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Show Empty"}),labelPlacement:"start"}),(0,s.jsx)(e1._$,{className:"datagrid-vertical",rows:g,columns:p,disableRowSelectionOnClick:!0,disableDensitySelector:!0,disableColumnMenu:!0,pageSizeOptions:[100],density:"compact",onCellKeyDown:(e,t)=>{("Delete"===t.key||"Backspace"===t.key)&&n(0,e)}})]})]})})]})})}function to(e){let{nodes:t,edges:n,options:r}=e,a=(0,l.useContext)(ti),i=(0,l.useContext)(tH),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=o.current?(0,e6.S1)(o.current,"dark",{renderer:"canvas"}):null,t=()=>e&&e.resize();return e&&e.on("click",e=>{("node"===e.dataType||"graphGL"===e.componentSubType)&&(a(e.name,!0),i({type:"add",state:{type:"term",value:e.name}}))}),window.addEventListener("resize",t),()=>{if(e){let t=e._chartsViews;t&&t.forEach(e=>{e._layouting&&(e._layouting=!1,clearTimeout(e._layoutTimeout))}),e.dispose()}window.removeEventListener("resize",t)}},[r.layout]),(0,l.useEffect)(()=>{if(o.current){let e=(0,e6.JE)(o.current);if(e){if(r.hide_zeros&&(t=t.filter(e=>!!e.value)),t=t.map(e=>(e.label={show:e.value>=r.label_threshold},e)),n.length){let s={};t.forEach(e=>{if("string"==typeof e.category)s[e.category]=!0;else{let t="";e.category.forEach(e=>{s[e]=!0,t=e}),e.category=t}e.symbolSize=r.size_by_value?7+18*e.prop:10});let a=Object.keys(s).map(e=>({name:e}));e.setOption({legend:{align:"right",right:"right",orient:"vertical",type:"plain",pageButtonGap:10},tooltip:{confine:!0,formatter:e=>e.marker+(e.data.host?"<i>("+e.data.host+")</i> ":"")+e.name+": <strong>"+e.value.toFixed(3)+"</strong>"},backgroundColor:"#000",series:["forceAtlas2"===r.layout?{type:"graphGL",nodes:t,edges:n,categories:a,roam:!0,label:{show:!0,position:"top",color:"#fff"},lineStyle:{color:"source"},emphasis:{focus:"adjacency",lineStyle:{color:"#fff",opacity:1,width:10}}}:{type:"graph",layout:r.layout,nodes:t,edges:n,categories:a,roam:!0,label:{show:!0,position:"top"},emphasis:{focus:"adjacency",itemStyle:{opacity:1},label:{opacity:1},lineStyle:{width:10,opacity:1}},blur:{itemStyle:{opacity:.3},lineStyle:{opacity:.3},label:{opacity:.3}},autoCurveness:!0,draggable:!0,force:{repulsion:r.repulsion,gravity:r.gravity,edgeLength:r.edge_length},circular:{rotateLabel:!0},lineStyle:{color:"source"}}]},!1,"forceAtlas2"!==r.layout)}else e.clear()}}},[t,n,r]),(0,s.jsx)(eM.Z,{ref:o,sx:{width:"100%",height:"100%",minHeight:"10px"}})}function tc(e,t){return{lemma:+(e in t.lemma),lemma_related:+(e in t.lemma_related),lemma_synset:+(e in t.lemma_synset),related:+(e in t.related),related_lemma:+(e in t.related_lemma),related_related:+(e in t.related_related),related_synset:+(e in t.related_synset),synset:+(e in t.synset),synset_lemma:+(e in t.synset_lemma),synset_related:+(e in t.synset_related),synset_synset:+(e in t.synset_synset)}}async function td(e,t,n,s,r,a,i){clearTimeout(tg.comparisons);let l=Object.keys(t),o=l.length;for(let r=0;e<o&&r<100;r++,e++){let r=t[l[e]];r.processed.lookup.map.forEach((e,a)=>{let l=r.term+"."+a,o=a+"."+r.term;if(r.term!==a&&!(l in s)&&!(o in s)&&a in t){s[l]=s[o]=!0;let e=function(e,t,n){if(!t.processed)return 0;let s=tc(e.term,t.processed.lookup);return n?.35*s.lemma+.1*s.lemma_related+.001*s.lemma_synset+.25*s.related+.1*s.related_lemma+.001*s.related_related+.001*s.related_synset+.001*s.synset+.001*s.synset_lemma+.001*s.synset_related+.001*s.synset_synset:.35*s.lemma+.25*s.related+.001*s.synset}(r,t[a],i.dense);e>i.min_sim&&n.push({source:r.term,target:a,value:e,lineStyle:{width:.3+2*e,opacity:.35}})}})}r([e,o]),e<o?tg.comparisons=setTimeout(()=>td(e,t,n,s,r,a,i),0):setTimeout(()=>{let e={},s=Object.values(t).map((t,n)=>(e[t.term]=n,{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,host:t.host||"",category:Object.keys(t.categories),name:t.term,prop:1,value:0,symbolSize:10,itemStyle:{opacity:1},label:{show:!0}}));n.forEach(t=>{s[e[t.source]].value+=t.value,s[e[t.target]].value+=t.value});let r=0;s.forEach(e=>{let{value:t}=e;t>r&&(r=t)}),a({edges:n,nodes:s.map(e=>(e.prop=e.value/r,e.itemStyle={opacity:.6+.4*e.prop},e))})},0)}function th(e){let{selectedCategories:t,options:n,plotOptions:r}=e,a=(0,l.useContext)(z),i=(0,l.useContext)(ej),o=(0,l.useMemo)(()=>{let e={},t=[];return Object.keys(i).forEach(s=>{let r=tw(s,a,i,!0);"fixed"===r.type?s in e||(e[s]=!0,t.push({term:s,categories:i[s].categories,processed:r})):n.include_fuzzy&&r.matches.forEach(n=>{n in i||n in e||(e[n]=!0,t.push({host:s,term:n,categories:i[s].categories,processed:tw(n,a,{},!0)}))})}),t},[i,a,n]),[c,u]=(0,l.useState)({edges:[],nodes:[]}),[m,x]=(0,l.useState)([0,0]);return(0,l.useEffect)(()=>{let e=new Map(t.map((e,t)=>[t,e])),s={};o.forEach(t=>{let n=!1,r={};e.forEach(e=>{e in t.categories&&(n=!0,r[e]=t.categories[e])}),n&&(s[t.term]={...t,categories:r})}),td(0,s,[],{},x,u,n)},[o,t]),m[0]<m[1]?(0,s.jsx)(eM.Z,{sx:{position:"relative",width:"100%",height:"100%"},children:(0,s.jsx)(eM.Z,{sx:{display:"flex",position:"absolute",top:0,right:0,bottom:0,left:0,alignItems:"center",justifyContent:"center",textAlign:"center"},children:(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(h.Z,{variant:"h5",children:"Calculating Pairwise Similarities"}),(0,s.jsx)(eQ.Z,{variant:"determinate",value:m[0]/m[1]*100}),(0,s.jsx)(h.Z,{variant:"caption",children:m[0]+" / "+m[1]})]})})}):(0,s.jsx)(eM.Z,{sx:{position:"relative",width:"100%",height:"100%"},children:(0,s.jsx)(to,{nodes:c.nodes,edges:c.edges,options:r})})}function tu(e){let{name:t,current:n,edit:r}=e,a=(0,l.useContext)(z),{terms:i,collapsedTerms:o,termLookup:c}=a,u=(0,l.useContext)(ej),m=(0,l.useMemo)(()=>{let e={};return Object.keys(u).forEach(t=>e[t]=!0),e},[u]),x=(0,l.useMemo)(()=>({all:";;"+Object.keys(u).join(";;")+";;"}),[u]),[p,y]=(0,l.useState)(!1),g=()=>y(!p),[Z,b]=(0,l.useState)(!0),[C,_]=(0,l.useState)(!0),[w,k]=(0,l.useState)(!0),[S,E]=(0,l.useState)(!0),[O,N]=(0,l.useState)(1),[P,M]=(0,l.useState)(""),[T,W]=(0,l.useState)([]),[D,K]=(0,l.useState)([]),J=S?e=>c&&e in c:e=>e in m,V=e=>{e&&!D.includes(e)&&J(e)&&K([...D,e])};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.Z,{onClick:g,fullWidth:!0,children:"Fill Weights"}),p&&(0,s.jsxs)(B.Z,{open:p,onClose:g,children:[(0,s.jsx)(H.Z,{children:"Category Weight Filler"}),(0,s.jsx)(A.Z,{"aria-label":"close category weight filler",onClick:g,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsx)(U.Z,{sx:{minWidth:"300px",minHeight:"300px",p:1},children:(0,s.jsxs)(d.Z,{spacing:2,children:[(0,s.jsx)(eF.Z,{title:C?"Weights will be similarity to the specified core terms":"Will use the specified value as the weight of all terms",placement:"right",children:(0,s.jsx)(R.Z,{control:(0,s.jsx)(I.Z,{size:"small",checked:C,onChange:()=>_(!C)}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Similarity-based"}),labelPlacement:"start"})}),C&&i?(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(e3.Z,{multiple:!0,disableCloseOnSelect:!0,options:T,onKeyUp:e=>{let t="value"in e.target?e.target.value:"";if("Enter"===e.code&&P&&(!t||t===P)){V(t);return}if(i){let e=[];if(t&&o){let n;try{n=RegExp(j.test(t)?v(t):";"+t+"[^;]*;","g")}catch(e){n=RegExp(";"+t.replace(f,"\\%&")+";","g")}tv("",n,S?o:x,e,100)}D.forEach(t=>{e.includes(t)||e.push(t)}),W(e)}},value:D,onChange:(e,t)=>{1===Math.abs(t.length-D.length)&&K([...t])},renderTags:(e,t)=>e.map((e,n)=>(0,l.createElement)(e5.Z,{label:e,...t({index:n}),key:e})),renderInput:e=>(0,s.jsx)(L.Z,{...e,size:"small",label:"Core Terms",value:P,onChange:e=>{D.includes(e.target.value)||M(e.target.value)}}),filterOptions:e=>e,filterSelectedOptions:!0,selectOnFocus:!0,clearOnBlur:!0,clearOnEscape:!0,handleHomeEndKeys:!0,fullWidth:!0}),(0,s.jsxs)(e8.Z,{sx:{m:0,justifyContent:"space-between"},children:[(0,s.jsx)(q.Z,{onClick:()=>{W([]),K([])},children:"Clear"}),(0,s.jsx)(eF.Z,{title:S?"Allowing any terms from the full list on record":"Allowing only terms included in the category",placement:"top",children:(0,s.jsx)(R.Z,{control:(0,s.jsx)(I.Z,{size:"small",checked:S,onChange:()=>{W([]),E(!S)}}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Allow any terms"}),labelPlacement:"top"})}),(0,s.jsx)(eF.Z,{title:w?"Will rescaling similarities to be between 0 and 1":"Will display raw similarity values",placement:"top",children:(0,s.jsx)(R.Z,{control:(0,s.jsx)(I.Z,{size:"small",checked:w,onChange:()=>k(!w)}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Scale"}),labelPlacement:"top"})})]})]}):(0,s.jsx)(L.Z,{fullWidth:!0,size:"small",label:"Value",value:O,onChange:e=>N(+e.target.value)}),(0,s.jsx)(eF.Z,{title:Z?"Will apply weight to all terms in the dictionary":"Will apply weight only to terms with weight in the current category",placement:"right",children:(0,s.jsx)(R.Z,{control:(0,s.jsx)(I.Z,{size:"small",checked:Z,onChange:()=>b(!Z)}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Apply to all terms"}),labelPlacement:"start"})})]})}),(0,s.jsxs)(G.Z,{sx:{justifyContent:"space-between"},children:[(0,s.jsx)(q.Z,{onClick:g,children:"Cancel"}),(0,s.jsx)(q.Z,{variant:"contained",onClick:()=>{let e={};if(C){let t=new Map;D.forEach(e=>{let n=tw(e,a,u,!0);"fixed"===n.type?t.set(e,n.lookup):n.matches.forEach(e=>{t.set(e,tw(e,a,u,!0).lookup)})});let s=[1/0,-1/0];Object.keys(Z?u:n).forEach(n=>{let r=0;t.forEach(e=>{let t=tw(n,a,u);if("fixed"===t.type){let t=tc(n,e);r+=1*(t.lemma||t.related||t.synset)+.1*(t.lemma_related||t.lemma_synset)+.01*(t.related_lemma||t.related_related||t.related_synset)+.001*(t.synset_lemma||t.synset_related||t.synset_synset)}else t.matches.forEach(t=>{let n=tc(t,e);r+=1*(n.lemma||n.related||n.synset)+.1*(n.lemma_related||n.lemma_synset)+.01*(n.related_lemma||n.related_related||n.related_synset)+.001*(n.synset_lemma||n.synset_related||n.synset_synset)})}),w&&(s[0]>r&&(s[0]=r),s[1]<r&&(s[1]=r)),e[n]=r}),w&&Object.keys(e).forEach(t=>e[t]=(e[t]-s[0])/(s[1]-s[0]))}else Z?Object.keys(u).forEach(t=>e[t]=O):Object.keys(n).forEach(t=>{n[t]&&(e[t]=O)});r({type:"reweight_category",name:t,weights:e}),g()},children:"Fill"})]})]})]})}function tm(e){let{category:t,onClose:n}=e,[r,a]=(0,l.useState)(!1),i=(0,l.useContext)(eZ),o=(0,l.useContext)(z),c=(0,l.useContext)(ej),[u,m]=(0,l.useState)(t),[x,p]=(0,l.useState)(t);(0,l.useEffect)(()=>{p(t)},[t,p]),(0,l.useEffect)(()=>{m(x)},[x,m]);let y=(0,l.useContext)(ef),g=(0,l.useCallback)((e,n)=>{let{field:s,row:r}=n,{processed:a,dictEntry:i}=r;if(s){let n={...i.categories};t in n&&!e?delete n[t]:e&&(n[t]=e),y({type:"update",term:a.term,term_type:a.term_type,categories:n})}},[y,t]),j=(0,l.useMemo)(()=>new Map(Object.keys(c).map((e,t)=>[t,e])),[c]),f=(0,l.useMemo)(()=>{let e={};return j.forEach(n=>{let{categories:s}=c[n];t in s&&(e[n]=s[t])}),e},[c,j,t]),Z=(0,l.useMemo)(()=>{let e=[];return j.forEach(t=>{(r||t in f)&&e.push({id:t,weight:f[t]||"",dictEntry:c[t],processed:tw(t,o,c)})}),e},[o,c,j,r,f]);return t&&i.includes(t)?(0,s.jsxs)(B.Z,{open:!!t,onClose:n,children:[(0,s.jsx)(H.Z,{children:"Category Editor"}),(0,s.jsx)(A.Z,{"aria-label":"close category editor",onClick:n,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsx)(U.Z,{sx:{p:1,minWidth:"300px",height:"500px"},children:(0,s.jsxs)(d.Z,{sx:{height:"100%"},children:[(0,s.jsxs)(d.Z,{direction:"row",children:[(0,s.jsx)(L.Z,{label:"Name",fullWidth:!0,value:u,onChange:e=>m(e.target.value),size:"small"}),u!==t?(0,s.jsx)(q.Z,{variant:"contained",onClick:()=>{y({type:"rename_category",name:t,newName:u})},children:"Rename"}):(0,s.jsx)(s.Fragment,{})]}),(0,s.jsxs)(d.Z,{direction:"column",spacing:1,sx:{mt:2,height:"100%"},children:[(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Term Weights"}),(0,s.jsx)(R.Z,{control:(0,s.jsx)(I.Z,{size:"small",checked:r,onChange:()=>a(!r)}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Show Empty"}),labelPlacement:"start"}),(0,s.jsx)(e1._$,{className:"datagrid-vertical",rows:Z,columns:[{field:"id",headerName:"Term",width:170},{field:"weight",headerName:"Weight",width:95,editable:!0,hideable:!1,valueParser:(e,t)=>{let n=+e||"";return t&&g(n,t),n}}],disableRowSelectionOnClick:!0,disableDensitySelector:!0,disableColumnMenu:!0,pageSizeOptions:[100],density:"compact",slots:{toolbar:e2.T},onCellKeyDown:(e,t)=>{("Delete"===t.key||"Backspace"===t.key)&&g(0,e)}})]})]})}),(0,s.jsx)(G.Z,{children:(0,s.jsx)(tu,{name:t,current:f,edit:y})})]}):(0,s.jsx)(s.Fragment,{})}(0,e4.D)([e9.N,te.N,tn.N,tt.N,e7.N]);var tx=n(14837),tp=n(27140);function ty(e){let{rows:t,columns:n,isCategory:r,setEditCategory:a,editFromEvent:i}=e,o=(0,l.useContext)(ti);return(0,s.jsx)(e1._$,{sx:{"& .MuiFormControl-root":{position:"absolute",bottom:"4px",left:"12px"}},rows:t,columns:n,showCellVerticalBorder:!0,disableDensitySelector:!0,pageSizeOptions:[100],density:"compact",slots:{toolbar:e2.T,columnMenu:e=>{let t=e.colDef.headerName;return r(t)?(0,s.jsx)(tp.hh,{...e,slots:{columnMenuUserItem:()=>(0,s.jsxs)(eP.Z,{onClick:()=>{a(t)},children:[(0,s.jsx)(x.Z,{children:(0,s.jsx)(tx.Z,{fontSize:"small"})}),(0,s.jsx)(ed.Z,{children:"Edit category"})]})},slotProps:{columnMenuIserItem:{displayOrder:15}}}):(0,s.jsx)(tp.hh,{...e})}},onCellKeyDown:(e,t)=>{("Delete"===t.key||"Backspace"===t.key)&&i(0,e)},onRowClick:e=>{let{row:t}=e;o(t.id)}})}let tg={dictionary:0,comparisons:0};function tj(e,t){return t.dictEntry.added-e.dictEntry.added}function tf(e){let{editFromEvent:t}=e,n=(0,l.useContext)(z),r=(0,l.useContext)(ej),a=(0,l.useContext)(eZ),i=(0,l.useCallback)(e=>a.includes(e),[a]),o=(0,l.useContext)(ef),c=(0,l.useMemo)(()=>Object.freeze(Object.keys(r).sort()),[r]),u=(0,l.useMemo)(()=>{let e=[{field:"remove",headerName:"",width:1,sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,s.jsx)(A.Z,{sx:{opacity:.4,cursor:"not-allowed"},size:"small","aria-label":"remove term",onClick:()=>{o({type:"remove",term:e.id})},children:(0,s.jsx)(e0.Z,{sx:{fontSize:".9em"}})})},{field:"id",headerName:"Term",renderCell:e=>(0,s.jsx)(tK,{term:e.value})},{field:"sense",headerName:"Sense",description:"assigned sense key",editable:!0,renderEditCell:e=>(0,s.jsx)(tM,{id:e.id,field:e.field,processed:e.row.processed,editCell:e.api.setEditCellValue})},{field:"frequency",headerName:"Frequency",description:"relative frequency; 100 - index / n terms * 100; terms are loosely sorted by frequency and space coverage"},{field:"matches",headerName:"Matches",description:"number of matches found in the full term list"},{field:"senses",headerName:"Senses",description:"number of directly associated senses"},{field:"related",headerName:"Related",description:"number of similar terms on record, based on agreement between embeddings spaces"},{field:"ncats",headerName:"Categories",description:"number of categories the term has weight in"}];return a.forEach(n=>e.push({field:"category_"+n,headerName:n,editable:!0,valueParser:(e,n)=>{let s=+e||"";return n&&t(s,n),s}})),e},[a,t]),[m,x]=(0,l.useState)([]),[p,y]=(0,l.useState)(0),g=(0,l.useMemo)(()=>{if(c.length<1e3)return!1;let e=m.map(e=>{let{id:t}=e;return t}).sort();return!(2>Math.abs(e.length-c.length))&&e.join()!==c.join()},[m,c]);(0,l.useEffect)(()=>{n.termAssociations&&n.synsetInfo&&tS(r,n,g?y:void 0).then(e=>{x(e.sort(tj)),g&&y(0)})},[r,n,g]);let[j,f]=(0,l.useState)("");return(0,s.jsxs)(eM.Z,{component:"main",sx:{height:"100%"},children:[c.length?g?(0,s.jsx)(eX.Z,{open:!0,children:(0,s.jsxs)(d.Z,{direction:"column",sx:{textAlign:"center"},children:[(0,s.jsx)(h.Z,{variant:"h4",children:"Processing Dictionary"}),(0,s.jsx)(eQ.Z,{variant:"determinate",value:100*p}),(0,s.jsx)(h.Z,{variant:"caption",children:p?Math.round(100*p)+"%":"preparing..."})]})}):(0,s.jsx)(ty,{rows:m,columns:u,isCategory:i,setEditCategory:f,editFromEvent:t}):(0,s.jsx)(h.Z,{align:"center",children:"Add terms, or import an existing dictionary."}),(0,s.jsx)(tm,{category:j,onClose:()=>f("")})]})}let tZ={},tb={};async function tv(e,t,n){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=n[t.source[1]in n?t.source[1]:"all"];for(let n,i="";s.length<r&&(n=t.exec(a));)(i=n[0].replace(Z,""))&&(s.push(i),!e||i in tb||(tb[i]=e))}function tC(e,t,n){n.forEach((n,s)=>{e[s]=!0,t[s]=!0})}function t_(e,t){try{return new RegExp(e,t)}catch(t){return e}}function tw(e,t,n,s){let r=n&&e in n&&"regex"===n[e].type?"regex":"fixed",a=e+"_"+r;a in tZ||(tZ[a]=function(e,t){let n="string"==typeof e;if(n&&!g.test(e))return function(e,t){let{terms:n,lemmas:s,termLookup:r,termAssociations:a,synsetInfo:i}=t,l={type:"fixed",term:e,term_type:"fixed",categories:{},recognized:!1,index:n&&r&&r[e]||-1,lemma:[],related:[],synsets:[],synset_terms:[],lookup:{expanded:!1,map:new Map,any:{},lemma:{},lemma_map:new Map,lemma_related:{},lemma_synset:{},related:{},related_map:new Map,related_lemma:{},related_related:{},related_synset:{},synset:{},synset_map:new Map,synset_lemma:{},synset_related:{},synset_synset:{}}};if(a&&i&&s&&n&&-1!==l.index){l.recognized=!0;let t=a[l.index];l.related=t&&t[0]&&Array.isArray(t[0])?t[0].filter((e,t)=>!!t).map(e=>n[e-1]):[],l.synsets=t&&t[1]?(Array.isArray(t[1])?t[1]:[t[1]]).map(e=>i[e-1]):[];let r=new Set;l.synsets.forEach(e=>{eH(e,n,i).forEach(e=>{e!==l.term&&r.add(e)})}),l.synset_terms=Array.from(r);let o=n&&s&&e in s?s["number"==typeof s[e]?n[s[e]]:e]:[];l.lemma="number"==typeof o?[n[o]]:o.map(e=>n[e]),function(e){let{lemma:t,related:n,synset_terms:s,lookup:r}=e;t.forEach(e=>{r.any[e]=!0,r.lemma[e]=!0,r.lemma_map.set(e,!0)}),n.forEach(e=>{r.any[e]=!0,r.related[e]=!0,r.related_map.set(e,!0)}),s.forEach(e=>{r.any[e]=!0,r.synset[e]=!0,r.synset_map.set(e,!0)})}(l)}return l}(e,t);{let s=n?v(e):e.source,r={type:"fuzzy",term_type:n?"glob":"regex",term:n?e:e.source,categories:{},recognized:!1,regex:t_(n?s:k(s),"g"),matches:[]};return t.collapsedTerms&&tv(r.term,r.regex,t.collapsedTerms,r.matches),r.recognized=!!r.matches.length,r}}("regex"===r?t_(e):e,t));let i=tZ[a];return s&&"fixed"===i.type&&!i.lookup.expanded&&function(e,t){let n=e.lookup,s=n.any;e.lemma.forEach(e=>{let r=tw(e,t).lookup;tC(s,n.lemma_related,r.related_map),tC(s,n.lemma_synset,r.synset_map)}),e.related.forEach(e=>{let r=tw(e,t).lookup;tC(s,n.related_lemma,r.lemma_map),tC(s,n.related_related,r.related_map),tC(s,n.related_synset,r.synset_map)}),e.synset_terms.forEach(e=>{let r=tw(e,t).lookup;tC(s,n.synset_lemma,r.lemma_map),tC(s,n.synset_related,r.related_map),tC(s,n.synset_synset,r.synset_map)}),n.expanded=!0,n.map=new Map(Object.keys(s).map(e=>[e,!0]))}(i,t),i}async function tk(e,t,n,s,r){let a=tw(n,r,s),i=s[n],l="fixed"===a.type?{processed:a,dictEntry:i,id:n,sense:i.sense,matches:a.recognized?1:0,ncats:Object.keys(i.categories).length,frequency:_(a.index,r.terms&&r.terms.length).toFixed(2),senses:a.synsets.length,related:a.related.length}:{processed:a,dictEntry:i,id:n,sense:i.sense,matches:a.matches.length,ncats:Object.keys(i.categories).length};if(i.categories){let e=i.categories;Object.keys(e).forEach(t=>{l["category_"+t]=e[t]})}e[t]=l}async function tS(e,t,n){return clearTimeout(tg.dictionary),new Promise(s=>{let r=Object.freeze(Object.keys(e)),a=r.length,i=Array(a),l=0,o=0,c=()=>{for(clearTimeout(tg.dictionary);l<a&&o<1e3;l++,o++)tk(i,l,r[l],e,t);l!==a?(o=0,n&&n(l/a),tg.dictionary=setTimeout(c,0)):(n&&n(1),s(i))};tg.dictionary=setTimeout(c,0)})}var tE=n(91600),tz=n(4351),tO=n(21885),tN=n(94749),tP=n(68368),tF=n(33249);function tA(e,t){return t.score-e.score}function tM(e){let{id:t,field:n,processed:r,label:a,labelId:i,editCell:o}=e,c=(0,l.useContext)(ej),d=(0,l.useContext)(ef),u=c[r.term],m=(0,l.useContext)(z),{terms:x,sense_keys:p,synsetInfo:y}=m,g=(0,l.useMemo)(()=>{if(!x||!p||!y||"fixed"!==r.type||!r.synsets.length)return[];{let e=function(e,t){let n={};return Object.keys(t).forEach(s=>{let r=t[s];e.forEach(e=>{e in r.categories&&(n[s]=r)})}),n}(Object.keys(u.categories),c),t={};return Object.keys(e).forEach(e=>{let n=tw(e,m,c,!0);n.lookup&&n.lookup.map.forEach((e,n)=>t[n]=!0)}),r.synsets.map(n=>{let s=0;return eH(n,x,y).forEach(n=>{n in e&&s++,n in t&&(s+=.01)}),{score:s,synset:n}}).sort(tA)}},[x,p,y,r,c,m,u]);return x&&p&&y&&"fixed"===r.type&&r.synsets.length?(0,s.jsx)(eN.Z,{fullWidth:!0,size:"small","aria-label":"assign synset",value:u.sense,onChange:e=>{o&&o({id:t,field:n,value:e.target.value}),d({type:"update",term:r.term,term_type:r.term_type,sense:e.target.value})},label:a,labelId:i,children:g.map(e=>{let{score:t,synset:n}=e,{index:r}=n;return(0,s.jsx)(eP.Z,{value:p[r],children:(0,s.jsx)(eF.Z,{title:n.definition,placement:"right",children:(0,s.jsxs)(h.Z,{sx:{width:"100%"},children:[(0,s.jsx)("span",{className:"number-annotation",children:"("+t.toFixed(2)+") "}),p[r]]})})},r)})}):(0,s.jsx)(L.Z,{size:"small",value:u.sense,onChange:e=>{o&&o({id:t,field:n,value:e.target.value}),d({type:"update",term:r.term,term_type:r.term_type,sense:e.target.value})},label:a})}let tT=["Match","Frequency","Senses","Related","In Dictionary"],tW={position:"absolute",fontSize:"1.5em",height:"1.2em",opacity:.4};function tD(e){let{processed:t}=e,n=(0,l.useContext)(ej),r=(0,l.useContext)(ef),a=(0,l.useContext)(z),[i,o]=(0,l.useState)(0),[c,d]=(0,l.useState)(5),[u,m]=(0,l.useState)({column:"Frequency",asc:!1}),x=(0,l.useMemo)(()=>[(0,s.jsx)(eA.Z,{width:1},"term_action"),...tT.map(e=>(0,s.jsxs)(eA.Z,{width:"Match"===e?999:1,component:"th",align:"Match"===e?"left":"right",sx:{cursor:"pointer",pr:3},onClick:()=>{m(u.column===e&&u.asc?{column:"Frequency",asc:!1}:{column:e,asc:u.column===e})},children:[e,u.column===e?u.asc?(0,s.jsx)(tE.Z,{sx:tW}):(0,s.jsx)(tz.Z,{sx:tW}):(0,s.jsx)(s.Fragment,{})]},e))],[m,u]),p=t.matches.length,y=(0,l.useMemo)(()=>t.matches.map(e=>{let t=tw(e,a);return t.frequency=_(t.index,a.terms&&a.terms.length),t.in_dict=t.term in n,t}),[t,a,n]);if(i>p/c)return o(0),(0,s.jsx)(s.Fragment,{});y.sort(function(e){let{column:t,asc:n}=e;switch(t){case"Match":return n?(e,t)=>e.term>t.term?-1:1:(e,t)=>t.term>e.term?-1:1;case"Frequency":return n?(e,t)=>(e.frequency||0)-(t.frequency||0):(e,t)=>(t.frequency||0)-(e.frequency||0);case"Senses":return n?(e,t)=>e.synsets.length-t.synsets.length:(e,t)=>t.synsets.length-e.synsets.length;case"Related":return n?(e,t)=>e.related.length-t.related.length:(e,t)=>t.related.length-e.related.length;case"In Dictionary":return n?(e,t)=>(e.in_dict||0)>(t.in_dict||0)?-1:1:(e,t)=>(t.in_dict||0)>(e.in_dict||0)?-1:1}}(u));let g=[];if(p)for(let e=i*c,t=Math.min(y.length,e+c);e<t;e++)g.push(y[e]);if(!t.common_matches){let e="";t.matches.forEach(t=>{(!e||t.length<e.length)&&(e=t)}),t.common_matches=eY(e,";;"+t.matches.join(";;")+";;")}return(0,s.jsx)(eM.Z,{sx:{height:"100%",overflowY:"auto"},children:p?(0,s.jsxs)(eT.Z,{sx:{height:"100%"},children:[(0,s.jsxs)(eW.Z,{stickyHeader:!0,size:"small",sx:{width:"100%","& .MuiTableCell-root:first-of-type":{pl:1}},children:[(0,s.jsx)(eD.Z,{children:(0,s.jsx)(eR.Z,{children:x})}),(0,s.jsx)(eI.Z,{children:g.map((e,t)=>{let n=e.term;return(0,s.jsxs)(eR.Z,{sx:{height:33},hover:!0,children:[(0,s.jsx)(eA.Z,{sx:{p:0},children:e.in_dict?(0,s.jsx)(A.Z,{"aria-label":"remove",size:"small",edge:"start",sx:{p:0,opacity:.6},onClick:()=>{r({type:"remove",term:n})},children:(0,s.jsx)(tO.Z,{})}):(0,s.jsx)(A.Z,{"aria-label":"add",size:"small",edge:"start",sx:{p:0,opacity:.6},onClick:()=>{r({type:"add",term:n,term_type:"fixed"})},children:(0,s.jsx)(tN.Z,{})})}),(0,s.jsx)(eA.Z,{children:(0,s.jsx)(tK,{term:n})}),(0,s.jsx)(eA.Z,{align:"right",children:e.frequency&&e.frequency.toFixed(2)||"0.00"}),(0,s.jsx)(eA.Z,{align:"right",children:e.synsets.length}),(0,s.jsx)(eA.Z,{align:"right",children:e.related.length}),(0,s.jsx)(eA.Z,{align:"right",children:e.in_dict?"yes":"no"})]},n+t)})})]}),(0,s.jsx)(eL.Z,{component:"div",rowsPerPageOptions:[5,10,50,100,1e3],count:p,rowsPerPage:c,page:i,onPageChange:(e,t)=>{o(t)},onRowsPerPageChange:e=>{d(parseInt(e.target.value)),o(0)}})]}):(0,s.jsx)(h.Z,{children:"No matches"})})}let tR={minWidth:"20px",opacity:.9,"& .MuiSvgIcon-root":{fontSize:"1em"}};function tI(e,t,n,r){let a=e in tb?tb[e]:"",i=e in t;return(0,s.jsxs)(m.ZP,{disableGutters:!0,disablePadding:!0,sx:{pr:3},secondaryAction:i?(0,s.jsx)(A.Z,{"aria-label":"remove",size:"small",edge:"end",sx:tR,onClick:()=>{n({type:"remove",term:e})},children:(0,s.jsx)(tO.Z,{})}):(0,s.jsx)(A.Z,{"aria-label":"add",size:"small",edge:"end",sx:tR,onClick:()=>{n({type:"add",term:e,term_type:"fixed"})},children:(0,s.jsx)(tN.Z,{})}),children:[(0,s.jsx)(x.Z,{sx:tR,children:i?(0,s.jsx)(eF.Z,{title:"in current dictionary",placement:"left",children:(0,s.jsx)(tP.Z,{color:"success"})}):a&&a in t?(0,s.jsx)(eF.Z,{title:"captured by "+a+" in current dictionary",placement:"left",children:(0,s.jsx)(A.Z,{sx:{p:0,"& .MuiSvgIcon-root":{fontSize:".7em"}},onClick:()=>{r({type:"add",state:{type:"term",value:a}})},children:(0,s.jsx)(tF.Z,{color:"secondary"})})}):(0,s.jsx)(s.Fragment,{})}),(0,s.jsx)(tK,{term:e})]},e)}function tL(e){let{processed:t}=e,n={p:1,pl:0,maxHeight:"100%",overflowY:"auto",overflowX:"hidden"},r=(0,l.useContext)(ej),a=(0,l.useContext)(ef),i=(0,l.useContext)(tH),{terms:o,termLookup:c,collapsedTerms:x,sense_keys:p}=(0,l.useContext)(z),y=(0,l.useCallback)(c?(e,t)=>c[e]-c[t]:()=>0,[c]);return t.forms||(t.forms=eY(t.term,x?x.all:""),t.forms.sort(C)),(0,s.jsxs)(d.Z,{direction:"row",spacing:4,sx:{height:"100%"},children:[(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(eF.Z,{title:"100 - index / n terms * 100; terms are loosely sorted by frequency and space coverage",children:(0,s.jsx)(h.Z,{children:"Relative Frequency"})}),(0,s.jsx)(eM.Z,{sx:{p:1},children:(0,s.jsx)("span",{className:"number",children:_(t.index,o&&o.length).toFixed(2)})})]}),o&&t.lemma.length?(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(h.Z,{children:"Lemmatizer"}),(0,s.jsx)(eM.Z,{sx:n,children:(0,s.jsx)(u.Z,{disablePadding:!0,sx:{p:0},children:t.lemma.filter(e=>e!==t.term).map(e=>tI(e,r,a,i))})})]}):(0,s.jsx)(s.Fragment,{}),t.forms.length?(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(h.Z,{children:"Expansion"}),(0,s.jsx)(eM.Z,{sx:n,children:(0,s.jsx)(u.Z,{disablePadding:!0,sx:{p:0},children:t.forms.map(e=>tI(e,r,a,i))})})]}):(0,s.jsx)(s.Fragment,{}),t.related.length?(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(h.Z,{children:"Related Terms"}),(0,s.jsx)(eM.Z,{sx:n,children:(0,s.jsx)(u.Z,{disablePadding:!0,sx:{p:0},children:t.related.map(e=>tI(e,r,a,i))})})]}):(0,s.jsx)(s.Fragment,{}),p&&t.synsets.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(h.Z,{children:"Senses"}),(0,s.jsx)(eM.Z,{sx:n,children:(0,s.jsx)(u.Z,{sx:{p:0},children:t.synsets.map(e=>(0,s.jsx)(m.ZP,{disablePadding:!0,children:(0,s.jsx)(eq,{senseKey:p[e.index],info:e})},e.index))})})]}),t.synset_terms.length?(0,s.jsxs)(d.Z,{children:[(0,s.jsx)(h.Z,{children:"Extended Synset Members"}),(0,s.jsx)(eM.Z,{sx:n,children:(0,s.jsx)(u.Z,{disablePadding:!0,sx:{p:0},children:t.synset_terms.sort(y).map(e=>tI(e,r,a,i))})})]}):(0,s.jsx)(s.Fragment,{})]}):(0,s.jsx)(s.Fragment,{})]})}function tK(e){let{term:t}=e,n=(0,l.useContext)(tH);return(0,s.jsx)(q.Z,{fullWidth:!0,variant:"text",sx:{p:0,justifyContent:"flex-start",textTransform:"none"},onClick:()=>n({type:"add",state:{type:"term",value:t}}),children:t})}function tq(e){let{term:t}=e,n=tw(t,(0,l.useContext)(z),(0,l.useContext)(ej));return"fixed"===n.type?(0,s.jsx)(tL,{processed:n}):(0,s.jsx)(tD,{processed:n})}let tB=(0,l.createContext)([]),tH=(0,l.createContext)(e=>{});function tU(e){let{term:t}=e,n=(0,l.useContext)(ej),r=(0,l.useContext)(ef),a=t in n;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.Z,{sx:{overflowY:"auto",pb:0,pt:0},children:(0,s.jsx)(tq,{term:t})}),(0,s.jsx)(K.Z,{sx:{justifyContent:"flex-end",mt:"auto"},children:(0,s.jsx)(q.Z,{onClick:()=>{r(a?{type:"remove",term:t}:{type:"add",term:t,term_type:"fixed"})},children:a?"Remove":"Add"})})]})}function tG(e){let{info:t}=e;return(0,s.jsx)(D.Z,{sx:{overflowY:"auto",mb:"auto",pt:0},children:(0,s.jsx)(eV,{info:t})})}function tJ(){let e=(0,l.useContext)(ej),t=(0,l.useContext)(tH),n=(0,l.useContext)(ti),r=(0,l.useContext)(tB);if(!r.length)return;let a=()=>{t({type:"reset"})},i=r[0];return(0,s.jsx)(M.ZP,{open:""!==i.value,onClose:a,variant:"permanent",hideBackdrop:!0,anchor:"bottom",sx:{"& .MuiPaper-root":{height:ei,display:"flex",flexDirection:"column",justifyContent:"space-between"}},children:(0,s.jsxs)(T.Z,{children:[(0,s.jsx)(W.Z,{action:(0,s.jsx)(A.Z,{"aria-label":"Close info drawer",onClick:a,className:"close-button",children:(0,s.jsx)(F.Z,{})}),title:(0,s.jsxs)(d.Z,{direction:"row",children:[r.length>1?(0,s.jsx)(q.Z,{onClick:()=>t({type:"back"}),sx:{opacity:.8},children:r[1].value}):(0,s.jsx)(s.Fragment,{}),i.value in e?(0,s.jsx)(q.Z,{sx:{textTransform:"none",p:0},onClick:()=>n(i.value),children:(0,s.jsx)(h.Z,{variant:"h3",children:i.value})}):(0,s.jsx)(h.Z,{variant:"h3",children:i.value})]})}),"term"===i.type?(0,s.jsx)(tU,{term:i.value}):(0,s.jsx)(tG,{info:i.info})]})})}var tV=n(88938),t$=n(51469),tY=n(23341);let tX={type:"graph",layout:"force",size_by_value:!0,hide_zeros:!1,label_threshold:0,repulsion:100,gravity:.1,edge_length:40},tQ={include_fuzzy:!1,dense:!1,min_sim:.001};function t0(e,t){let n={...e};return e[t.key],n[t.key]=t.value,n}function t1(){let e=(0,l.useContext)(ej),t=(0,l.useContext)(eZ),[n,r]=(0,l.useReducer)(t0,tX),[a,i]=(0,l.useReducer)(t0,tQ),[o,c]=(0,l.useState)([]);(0,l.useEffect)(()=>{c(o.filter(e=>t.includes(e)))},[t]);let p=t.length,y=(0,l.useMemo)(()=>{let t={};return Object.values(e).forEach(e=>{Object.keys(e.categories).forEach(e=>{e in t?t[e]++:t[e]=1})}),t},[e]);return(0,s.jsxs)(d.Z,{direction:"row",sx:{height:"100%"},children:[(0,s.jsx)(eM.Z,{sx:{height:"100%",minWidth:"250px",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:(0,s.jsxs)(eM.Z,{sx:{pl:1,pr:1,height:"100%"},children:[(0,s.jsxs)(eM.Z,{sx:{maxHeight:"60%",overflowY:"auto"},children:[(0,s.jsx)(h.Z,{variant:"h6",children:"Terms"}),p?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{dense:!0,sx:{overflowY:"auto",maxHeight:"300px",p:0},children:t.map(e=>(0,s.jsx)(m.ZP,{disablePadding:!0,disableGutters:!0,children:(0,s.jsxs)(ec.Z,{disableGutters:!0,"aria-label":"toggle category",onClick:()=>{let t=[...o],n=t.indexOf(e);-1===n?t.push(e):t.splice(n,1),c(t)},children:[(0,s.jsx)(x.Z,{sx:{minWidth:"35px"},children:(0,s.jsx)(t$.Z,{sx:{p:0},checked:o.includes(e)})}),(0,s.jsx)(ed.Z,{sx:{m:0},primary:e,secondary:y[e]+" terms"})]})},e))}),(0,s.jsxs)(e8.Z,{sx:{justifyContent:"space-between"},variant:"dense",disableGutters:!0,children:[(0,s.jsxs)(d.Z,{direction:"row",children:[(0,s.jsx)(q.Z,{size:"small",sx:{minWidth:"1px"},onClick:()=>{c([...t])},children:"All"}),(0,s.jsx)(q.Z,{size:"small",sx:{minWidth:"1px"},onClick:()=>{c([])},children:"None"})]}),(0,s.jsx)(h.Z,{sx:{pr:1,whiteSpace:"nowrap"},children:o.length+" / "+p+" selected"})]})]}):(0,s.jsx)(h.Z,{textAlign:"center",children:"No Categories"}),(0,s.jsxs)(d.Z,{spacing:2,children:[(0,s.jsx)(eF.Z,{title:"Include all matches to fuzzy terms in the comparison.",placement:"right",children:(0,s.jsx)(R.Z,{label:"Fuzzy Matches",labelPlacement:"start",control:(0,s.jsx)(I.Z,{size:"small",checked:a.include_fuzzy,onChange:()=>i({key:"include_fuzzy",value:!a.include_fuzzy})})})}),(0,s.jsx)(eF.Z,{title:"Include second-order term relationships in similarity calculations, resulting in a denser network.",placement:"right",children:(0,s.jsx)(R.Z,{label:"Secondary Connections",labelPlacement:"start",control:(0,s.jsx)(I.Z,{size:"small",checked:a.dense,onChange:()=>i({key:"dense",value:!a.dense})})})}),(0,s.jsx)(eF.Z,{title:"Will consider nodes with similarity equal to or less than this as unconnected.",placement:"right",children:(0,s.jsx)(L.Z,{value:a.min_sim,type:"number",size:"small",label:"Similarity Threshold",onChange:e=>i({key:"min_sim",value:e.target.value})})})]})]}),(0,s.jsxs)(eM.Z,{sx:{maxHeight:"40%",overflowY:"auto"},children:[(0,s.jsx)(h.Z,{variant:"h6",sx:{mt:2},children:"Plot Options"}),(0,s.jsxs)(d.Z,{spacing:2,children:[(0,s.jsx)(R.Z,{label:"Hide Zeros",labelPlacement:"start",control:(0,s.jsx)(I.Z,{size:"small",checked:n.hide_zeros,onChange:()=>r({key:"hide_zeros",value:!n.hide_zeros})})}),(0,s.jsx)(R.Z,{label:"Size By Value",labelPlacement:"start",control:(0,s.jsx)(I.Z,{size:"small",checked:n.size_by_value,onChange:()=>r({key:"size_by_value",value:!n.size_by_value})})}),(0,s.jsx)(eF.Z,{title:"Will not show labels for nodes with values lower than this.",placement:"right",children:(0,s.jsx)(L.Z,{value:n.label_threshold,type:"number",size:"small",label:"Label Threshold",onChange:e=>r({key:"label_threshold",value:e.target.value})})}),"graph"===n.type?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ts.Z,{fullWidth:!0,children:[(0,s.jsx)(tr.Z,{id:"graph_layout_select",children:"Layout"}),(0,s.jsxs)(eN.Z,{labelId:"graph_layout_select",label:"Layout",size:"small",value:n.layout||"force",onChange:e=>{r({key:"layout",value:e.target.value})},children:[(0,s.jsx)(tY.Z,{children:"Canvas"}),(0,s.jsx)(eP.Z,{value:"none",children:"Random"}),(0,s.jsx)(eP.Z,{value:"circular",children:"Circular"}),(0,s.jsx)(eP.Z,{value:"force",children:"Force"}),(0,s.jsx)(tY.Z,{children:"WebGL"}),(0,s.jsx)(eP.Z,{value:"forceAtlas2",children:"ForceAtlas2"})]})]}),"force"===n.layout?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eF.Z,{title:"Repulsion factor between nodes.",placement:"right",children:(0,s.jsx)(L.Z,{value:n.repulsion,type:"number",size:"small",label:"Repulsion",onChange:e=>r({key:"repulsion",value:e.target.value})})}),(0,s.jsx)(eF.Z,{title:"Nodes' strength of attraction to the center.",placement:"right",children:(0,s.jsx)(L.Z,{value:n.gravity,type:"number",size:"small",label:"Gravity",onChange:e=>r({key:"gravity",value:e.target.value})})}),(0,s.jsx)(eF.Z,{title:"Base distance between nodes.",placement:"right",children:(0,s.jsx)(L.Z,{value:n.edge_length,type:"number",size:"small",label:"Edge Length",onChange:e=>r({key:"edge_length",value:e.target.value})})})]}):(0,s.jsx)(s.Fragment,{})]}):(0,s.jsx)(s.Fragment,{})]})]})]})}),(0,s.jsx)(th,{selectedCategories:o,options:a,plotOptions:n})]})}var t2=n(9540),t3=n(90880),t5=n(76500),t8=n(35843),t4=n(41101),t6=n(14172);function t9(e){let{setName:t,setContent:n}=e,r=(0,l.useContext)(eS),a=(0,l.useContext)(ep),[i,o]=(0,l.useState)(!1),c=()=>o(!i);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eF.Z,{title:"select an existing dictionary to import as a copy",children:(0,s.jsx)(q.Z,{variant:"outlined",onClick:c,children:"Copy"})}),i&&(0,s.jsxs)(B.Z,{open:i,onClose:c,children:[(0,s.jsx)(H.Z,{children:"Copy Dictionary"}),(0,s.jsx)(A.Z,{"aria-label":"close export menu",onClick:c,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsx)(U.Z,{sx:{p:0},children:(0,s.jsx)(u.Z,{sx:{p:0,pb:2},children:a.dictionary_names.map(e=>(0,s.jsx)(m.ZP,{sx:{p:0},children:(0,s.jsx)(ec.Z,{onClick:()=>ea(e,s=>{t(a.dictionary_names.includes(e+" Copy")?e+" Copy"+(1e4*Math.random()>>0):e+" Copy"),n(JSON.stringify(s,void 0,2)),c()},r,!!a.use_db),children:e})},e))})})]})]})}let t7=(0,t8.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),ne=/\t/,nt=/\s\s/,nn=/^\s+|\s+$/g,ns=/^["\s]+|["\s]+$/g,nr=/\s{2,}|\t+/g,na=/[[({]/,ni=/[\])}]/,nl=/([\[\]\(\)?^$.+])/;function no(e,t,n,s){return{added:Date.now(),type:s&&function(e){if(!nl.test(e))return!1;let t=na.test(e),n=ni.test(e);return t&&n||!t&&!n}(e)?"regex":"fixed",categories:t,sense:n||""}}function nc(){let e=(0,t4.Z)(),t=(0,l.useContext)(eg),[n,r]=(0,l.useState)(""),[a,i]=(0,l.useState)(!1),o=()=>i(!a),[c,h]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1),[x,p]=(0,l.useState)(""),[g,j]=(0,l.useState)(""),f=()=>{r(""),p(""),j("")},Z=()=>{n&&(f(),i(!1),t({type:"add",name:n,dict:function(e,t){let n={};if(e)try{if("%"===e[0]){let s=e.split(y),r={},a=s.length;if(a>1){let e=1;for(e=1;e<a;e++){let t=s[e].replace(nn,"");if("%"===t)break;let n=t.split(nr);n.length>1&&n[1]&&(r[n[0]]=n[1])}for(e++;e<a;e++){let a=s[e].replace(nn,"").split(nr);if(a.length>1){let e=a.splice(0,1)[0].toLowerCase();if(e){let s={};a.forEach(e=>{e in r&&(s[r[e]]=1)});let[i,l]=e.split("@");n[i]=no(i,s,l,t)}}}}}else if("{"===e[0]){let s=JSON.parse(e),r=Object.keys(s);if(r.length&&"type"in s[r[0]]&&"string"==typeof s[r[0]].type)return s;r.forEach(e=>{if(e){let r=s[e];Array.isArray(r)?r.forEach(s=>{if(s){if(s in n)n[s].categories[e]=1;else{let[r,a]=s.toLowerCase().split("@");n[s]=no(r,{[e]:1},a,t)}}}):Object.keys(r).forEach(s=>{if(s){if(s in n)n[s].categories[e]=r[s];else{let[a,i]=s.toLowerCase().split("@");n[s]=no(a,{[e]:r[a]},i,t)}}})}})}else{let s=e.split(y),r=ne.test(s[0])?"	":nt.test(s[0])?"  ":",",a=s.splice(0,1)[0].split(r).map(e=>e.replace(ns,""));a.splice(0,1);let i="term_sense"===a[0];s.forEach(e=>{let s=e.split(r).map(e=>e.replace(ns,"")),l=s.splice(0,1)[0].toLowerCase();if(l){let e="",r={};s.forEach((t,n)=>{if(t&&a[n]){let s=+t;!e&&(i&&0===n||isNaN(s))?e=t:r[a[n]]=+t}}),n[l]=no(l,r,e,t)}})}}catch(e){}return n}(x,c),password:u?g:""}))};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.Z,{variant:"outlined",onClick:o,children:"New"}),(0,s.jsxs)(B.Z,{open:a,onClose:o,onDrop:e=>{if(e.preventDefault(),e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length){let t=e.dataTransfer.files[0],n=new FileReader;n.onload=()=>{r(E(t.name)),p(n.result)},n.readAsText(t)}},children:[(0,s.jsx)(H.Z,{children:"Add Dictionary"}),(0,s.jsx)(A.Z,{"aria-label":"close import menu",onClick:o,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsx)(U.Z,{sx:{p:1},children:(0,s.jsxs)(d.Z,{spacing:1,children:[(0,s.jsx)(L.Z,{size:"small",label:"Name",value:n,onKeyDown:e=>{n&&"Enter"===e.code&&Z()},onChange:e=>{r(e.target.value)}}),(0,s.jsxs)(ts.Z,{children:[(0,s.jsx)(t6.Z,{sx:{fontSize:".8em"},htmlFor:"import_content",children:"Import Content"}),(0,s.jsx)("textarea",{id:"import_content",style:{backgroundColor:e.palette.background.default,color:e.palette.text.primary,whiteSpace:x?"pre":"normal",minWidth:"30em",minHeight:"20em"},value:x,onChange:e=>{p(e.target.value)},placeholder:"drag and drop a file, or enter content directly; see export menu for format examples"})]}),(0,s.jsx)(eF.Z,{title:"Attempt to convert terms to regular expressions if they contain special RegEx characters.",placement:"top",children:(0,s.jsx)(R.Z,{label:"Detect RegEx",labelPlacement:"start",control:(0,s.jsx)(I.Z,{checked:c,onChange:()=>h(!c)})})}),(0,s.jsx)(eF.Z,{title:"Encrypt dictionary and history when being stored.",placement:"right",children:(0,s.jsx)(R.Z,{label:"Encrypt",labelPlacement:"start",control:(0,s.jsx)(I.Z,{checked:u,onChange:()=>m(!u)})})}),u?(0,s.jsx)(L.Z,{size:"small",label:"Password",type:"password",value:g,onChange:e=>j(e.target.value)}):(0,s.jsx)(s.Fragment,{})]})}),(0,s.jsxs)(G.Z,{sx:{justifyContent:"space-between"},children:[(0,s.jsxs)(d.Z,{direction:"row",spacing:1,children:[(0,s.jsx)(t9,{setName:r,setContent:p}),(0,s.jsx)(eF.Z,{title:"select a file to import a dictionary from",children:(0,s.jsxs)(q.Z,{variant:"outlined",component:"label",children:["File",(0,s.jsx)(t7,{type:"file",onChange:e=>{if(e.target.files&&e.target.files.length){let t=e.target.files[0],n=new FileReader;n.onload=()=>{r(E(t.name)),p(n.result)},n.readAsText(t)}}})]})}),(0,s.jsx)(eF.Z,{title:"clear current content",children:(0,s.jsx)(q.Z,{onClick:f,children:"clear"})})]}),(0,s.jsx)(q.Z,{variant:"contained",disabled:!!u&&!g,onClick:Z,children:"Add"})]})]})]})}function nd(){let e=(0,t4.Z)(),t=(0,l.useContext)(ep),n=(0,l.useContext)(ej),[r,a]=(0,l.useState)(!1),i=()=>a(!r),[o,c]=(0,l.useState)("dic"),[u,m]=(0,l.useState)("csv"),[x,p]=(0,l.useState)(t.selected),[y,g]=(0,l.useState)("unweighted"),[j,f]=(0,l.useState)(!1),Z=(0,l.useMemo)(()=>r?function(e,t,n,s,r){switch(t){case"tabular":let a=function(e){switch(e){case"csv":return",";case"tsv":return"	";default:return"  "}}(n),i=Object.keys(e),l=new Set;i.forEach(t=>{let n=e[t].categories;n&&Object.keys(n).forEach(e=>l.add(e))});let o=Array.from(l),c=new Map(o.map((e,t)=>[t,e]));return'"term"'+a+'"'+(r?'term_sense"'+a+'"':"")+o.join('"'+a+'"')+'"\n'+i.map(t=>{let n=e[t].categories,s='"'+t+'"';return r&&(s+=a+e[t].sense),c.forEach(e=>{s+=a+(e in n?n[e]:"")}),s}).join("\n");case"dic":let d={},h=0,u="";return Object.keys(e).forEach(t=>{let n=e[t].categories;if(n){let s=[t];r&&e[t].sense&&(s[0]+="@"+e[t].sense),Object.keys(n).forEach(e=>{e in d||(d[e]=++h),s.push(d[e])}),u+="\n"+s.join("	")}}),"%\n"+Object.keys(d).map(e=>d[e]+"	"+e).join("\n")+"\n%"+u;case"json":if("full"===s)return JSON.stringify(e,void 0,2);let m={};if(Object.keys(e).forEach(t=>{let n=e[t].categories;n&&(r&&e[t].sense&&(t+="@"+e[t].sense),Object.keys(n).forEach(e=>{e in m||(m[e]={}),m[e][t]=n[e]}))}),"weighted"===s)return JSON.stringify(m,void 0,2);let x={};return Object.keys(m).forEach(e=>{x[e]=Object.keys(m[e])}),JSON.stringify(x,void 0,2);default:return""}}(n,o,u,y,j):"",[r,n,o,u,y,j]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.Z,{variant:"outlined",onClick:i,children:"Export"}),r&&(0,s.jsxs)(B.Z,{open:r,onClose:i,children:[(0,s.jsx)(H.Z,{children:"Export Dictionary"}),(0,s.jsx)(A.Z,{"aria-label":"close export menu",onClick:i,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsx)(U.Z,{sx:{p:1},children:(0,s.jsxs)(d.Z,{spacing:1,children:[(0,s.jsx)(L.Z,{size:"small",label:"Filename",value:x,onChange:e=>{p(e.target.value)}}),(0,s.jsxs)(ts.Z,{children:[(0,s.jsx)(t6.Z,{sx:{fontSize:".8em"},htmlFor:"export_content",children:"Export Content"}),(0,s.jsx)("textarea",{id:"export_content",style:{backgroundColor:e.palette.background.default,color:e.palette.text.primary,whiteSpace:"pre",minWidth:"35em",minHeight:"20em"},value:Z,onChange:()=>{}})]})]})}),(0,s.jsxs)(G.Z,{sx:{justifyContent:"space-between"},children:[(0,s.jsxs)(d.Z,{direction:"row",spacing:1,children:["json"!==o||"full"!==y?(0,s.jsx)(R.Z,{sx:{transform:"translate(0, -10px)"},control:(0,s.jsx)(I.Z,{size:"small",checked:j,onChange:()=>f(!j)}),label:(0,s.jsx)(h.Z,{variant:"caption",children:"Senses"}),labelPlacement:"top"}):(0,s.jsx)(s.Fragment,{}),(0,s.jsxs)(ts.Z,{children:[(0,s.jsx)(tr.Z,{id:"export_format",children:"Format"}),(0,s.jsxs)(eN.Z,{labelId:"export_format",label:"Format",size:"small",value:o,onChange:e=>{c(e.target.value)},children:[(0,s.jsx)(eP.Z,{value:"dic",children:"DIC"}),(0,s.jsx)(eP.Z,{value:"json",children:"JSON"}),(0,s.jsx)(eP.Z,{value:"tabular",children:"Tabular"})]})]}),"tabular"===o?(0,s.jsxs)(ts.Z,{children:[(0,s.jsx)(tr.Z,{id:"export_separator",children:"Type"}),(0,s.jsxs)(eN.Z,{labelId:"export_separator",label:"Type",size:"small",value:u,onChange:e=>{m(e.target.value)},children:[(0,s.jsx)(eP.Z,{value:"csv",children:"CSV"}),(0,s.jsx)(eP.Z,{value:"tsv",children:"TSV"}),(0,s.jsx)(eP.Z,{value:"dat",children:"DAT"})]})]}):(0,s.jsx)(s.Fragment,{})," ","json"===o?(0,s.jsxs)(ts.Z,{children:[(0,s.jsx)(tr.Z,{id:"export_json_type",children:"Type"}),(0,s.jsxs)(eN.Z,{labelId:"export_json_type",label:"Type",size:"small",value:y,onChange:e=>{g(e.target.value)},children:[(0,s.jsx)(eP.Z,{value:"weighted",children:"Weighted"}),(0,s.jsx)(eP.Z,{value:"unweighted",children:"Unweighted"}),(0,s.jsx)(eP.Z,{value:"full",children:"Full"})]})]}):(0,s.jsx)(s.Fragment,{})]}),(0,s.jsx)(q.Z,{variant:"contained",onClick:()=>{if(x&&Z){let e=document.createElement("a");e.setAttribute("href",URL.createObjectURL(new Blob([Z],{type:"text/plain"}))),e.setAttribute("download",x+"."+("tabular"===o?u:o)),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},children:"Download"})]})]})]})}function nh(){let e=(0,l.useContext)(ep),[t,n]=(0,l.useState)(!1),r=()=>n(!t),[a,i]=(0,l.useState)(""),o=(0,l.useContext)(eg),c=(0,l.useContext)(eZ),x=(0,l.useContext)(eb),p=(0,l.useContext)(ef),[y,g]=(0,l.useState)(""),j=()=>{y&&-1===c.indexOf(y)&&(x({type:"add",cat:y}),g(""))},f=(0,l.useMemo)(()=>c.map(e=>(0,s.jsx)(m.ZP,{disablePadding:!0,disableGutters:!0,secondaryAction:(0,s.jsx)(A.Z,{"aria-label":"delete category",sx:{opacity:.5},onClick:()=>{p({type:"remove_category",name:e}),x({type:"remove",cat:e})},children:(0,s.jsx)(e0.Z,{})}),children:(0,s.jsx)(ec.Z,{dense:!0,onClick:()=>i(e),children:(0,s.jsx)(ed.Z,{primary:e})})},e)),[c,p,x]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(q.Z,{variant:"text",sx:{fontWeight:"bold"},onClick:r,children:e.selected}),(0,s.jsx)(M.ZP,{anchor:"left",open:t,onClose:r,children:(0,s.jsxs)(T.Z,{sx:{height:"100%",width:"20em",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,s.jsx)(W.Z,{title:(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Dictionary Menu"}),action:(0,s.jsx)(A.Z,{onClick:r,"aria-label":"close dictionary menu",className:"close-button",children:(0,s.jsx)(F.Z,{})})}),(0,s.jsxs)(d.Z,{direction:"row",sx:{mb:2},children:[(0,s.jsxs)(ts.Z,{fullWidth:!0,children:[(0,s.jsx)(tr.Z,{id:"dictionary_select",children:"Current"}),(0,s.jsx)(eN.Z,{labelId:"dictionary_select",label:"Current",size:"small",value:e.selected,onChange:e=>{o({type:"set",name:e.target.value})},children:e.dictionary_names.map(e=>(0,s.jsx)(eP.Z,{value:e,children:e},e))})]}),(0,s.jsx)(nc,{})]}),(0,s.jsx)(D.Z,{sx:{alignContent:"left",mb:"auto",pt:0,pb:1,height:"100%",overflow:"hidden"},children:(0,s.jsxs)(d.Z,{spacing:1,sx:{height:"100%",overflowY:"auto"},children:[(0,s.jsxs)(T.Z,{elevation:5,sx:{height:"40%",minHeight:"300px",display:"flex",flexDirection:"column"},children:[(0,s.jsx)(W.Z,{title:(0,s.jsx)(h.Z,{fontWeight:"bold",children:"Categories"}),sx:{pb:0}}),(0,s.jsx)(D.Z,{sx:{p:0,mb:"auto",overflowY:"auto"},children:(0,s.jsx)(u.Z,{dense:!0,children:f})}),(0,s.jsx)(K.Z,{children:(0,s.jsxs)(d.Z,{direction:"row",children:[(0,s.jsx)(L.Z,{label:"New Category Name",size:"small",value:y,onKeyDown:e=>{"Enter"===e.code&&j()},onChange:e=>{g(e.target.value)}}),(0,s.jsx)(q.Z,{onClick:j,children:"Add"})]})})]}),(0,s.jsx)(ex,{})]})}),(0,s.jsx)(K.Z,{children:(0,s.jsxs)(d.Z,{direction:"column",sx:{width:"100%"},spacing:1,children:[(0,s.jsx)(nd,{}),(0,s.jsx)(J,{label:"Delete",message:"Delete the "+e.selected+" dictionary?",onConfirm:()=>{o({type:"delete",name:e.selected})}})]})})]})}),(0,s.jsx)(tm,{category:a,onClose:()=>i("")})]})}function nu(e){let{terms:t,exists:n,asTable:r,setAsTable:a,add:i}=e,[o,c]=(0,l.useState)(""),[h,u]=(0,l.useState)(!1),[x,p]=(0,l.useState)([]),[y,g]=(0,l.useState)(!1),Z=(0,l.useContext)(tH),{collapsedTerms:b}=(0,l.useContext)(z),C=e=>{let t=e?"string"==typeof e?e:"innerText"in e.target?e.target.innerText:o:o;if(t&&!n(t)){if(y){let e=t;try{e=new RegExp(e)}catch(e){}i(e,"regex")}else i(t,"fixed");p([]),c("")}},_=e=>{let t=e.target;if(t&&"value"in t){let e=t.value.toLowerCase();u(n(e)),c(e)}};return(0,s.jsx)(t5.Z,{component:"nav",children:(0,s.jsxs)(e8.Z,{variant:"dense",sx:{justifyContent:"space-between"},disableGutters:!0,children:[(0,s.jsx)(nh,{}),(0,s.jsxs)(d.Z,{direction:"row",sx:{width:"calc(min(500px, 50%))"},spacing:1,children:[(0,s.jsx)(e3.Z,{options:x,value:o,onKeyUp:e=>{let n="value"in e.target?e.target.value:"";if("Enter"===e.code&&(!n||n===o))return C(o);if(n!==o&&_(e),t){let e=[];if(o&&b){let t;try{t=RegExp(y?k(o):j.test(o)?v(o):";"+o+"[^;]*;","g")}catch(e){t=RegExp(";"+o.replace(f,"\\%&")+";","g")}tv("",t,b,e,100)}p(e)}},onChange:_,renderOption:(e,t)=>(0,l.createElement)(m.ZP,{...e,key:t,onClick:C},t),renderInput:e=>(0,s.jsx)(L.Z,{...e,size:"small",placeholder:"Term to add",value:o,onChange:_,error:h}),filterOptions:e=>e,selectOnFocus:!0,clearOnBlur:!0,clearOnEscape:!0,handleHomeEndKeys:!0,fullWidth:!0,freeSolo:!0}),(0,s.jsx)(eF.Z,{title:"regular expression characters are "+(y?"active":"escaped"),children:(0,s.jsx)(A.Z,{"aria-label":"toggle regular expression",onClick:()=>g(!y),children:y?(0,s.jsx)(t2.Z,{}):(0,s.jsx)(t3.Z,{})})}),(0,s.jsx)(q.Z,{variant:"outlined",disabled:!o,onClick:()=>{o&&Z({type:"add",state:{type:"term",value:o}})},children:"View"}),(0,s.jsx)(q.Z,{variant:"contained",onClick:()=>C(),disabled:!o||h,children:"Add"})]}),(0,s.jsxs)(d.Z,{direction:"row",children:[(0,s.jsx)(q.Z,{variant:"outlined",sx:{width:100},onClick:()=>a(!r),children:r?"Analyze":"Edit"}),(0,s.jsx)(eo,{})]})]})})}function nm(){let e=(0,l.useContext)(ew),t=(0,l.useContext)(eE),n=(0,l.useContext)(eS),r=(0,l.useContext)(eg),[a,i]=(0,l.useState)(!1),o=()=>{d(""),r({type:"set",name:"default"}),n("")},[c,d]=(0,l.useState)(""),u=()=>{c&&(i(!1),t(c).then(()=>{n(""),d("")}).catch(()=>{d(""),i(!0)}))};return(0,s.jsxs)(B.Z,{open:!!e,onClose:o,children:[(0,s.jsx)(H.Z,{children:"Decrypt Dictionary"}),(0,s.jsx)(A.Z,{"aria-label":"close export menu",onClick:o,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,s.jsx)(F.Z,{})}),(0,s.jsxs)(U.Z,{sx:{p:1},children:[(0,s.jsxs)(h.Z,{children:["Enter the password for the ",e," dictionary:"]}),(0,s.jsx)(L.Z,{fullWidth:!0,size:"small",type:"password",value:c,error:a,onKeyDown:e=>{"Enter"===e.code&&u()},onChange:e=>{d(e.target.value)}})]}),(0,s.jsxs)(G.Z,{sx:{justifyContent:"space-between"},children:[(0,s.jsx)(q.Z,{onClick:o,children:"Cancel"}),(0,s.jsx)(q.Z,{variant:"contained",onClick:u,children:"Decrypt"})]})]})}let nx=/^category_/;function np(){let[e,t]=(0,l.useState)(!0),n=(0,l.useContext)(ej),r=(0,l.useContext)(eZ),{terms:a}=(0,l.useContext)(z),i=(0,l.useContext)(ef),o=(0,l.useCallback)((e,t)=>{let{field:n,row:s}=t,{processed:r,dictEntry:a}=s;if(n&&("from_term_editor"===n||n.startsWith("category_"))){let t={...a.categories},l="from_term_editor"===n?s.id:n.replace(nx,"");l in t&&!e?delete t[l]:e&&(t[l]=e),i({type:"update",term:r.term,term_type:r.term_type,categories:t})}},[i]),c=(0,l.useContext)(ta),d=(0,l.useContext)(tB),h=c in n,u=d.length?ei:0;return(0,s.jsxs)(tV.Z,{children:[(0,s.jsx)(nu,{terms:a,exists:e=>e in n,asTable:e,setAsTable:t,add:(e,t)=>{i({type:"add",term:e,term_type:t})}}),(0,s.jsxs)(eM.Z,{sx:{position:"absolute",top:0,left:0,bottom:0,right:h?el:0,mt:"3em",mb:u},children:[e?(0,s.jsx)(tf,{editFromEvent:o}):(0,s.jsx)(t1,{}),h?(0,s.jsx)(tl,{categories:r,editor:o}):(0,s.jsx)(s.Fragment,{}),(0,s.jsx)(tJ,{})]}),(0,s.jsx)(nm,{})]})}let ny=(0,r.Z)({palette:{mode:"dark",primary:{main:"#b393d3"},success:{main:"#4986cb"},error:{main:"#e0561c"}}}),ng=(e,t)=>{switch("reset"!==t.type&&e.length||setTimeout(()=>window.dispatchEvent(new Event("resize")),0),t.type){case"add":return e.length&&e[0].value===t.state.value?[...e]:[t.state,...e];case"back":return[...e].splice(1,e.length);default:return[]}};function nj(){let[e,t]=(0,l.useReducer)(ng,[]),[n,r]=(0,l.useState)("");return(0,s.jsx)(l.StrictMode,{children:(0,s.jsxs)(a.Z,{theme:ny,children:[(0,s.jsx)(i.ZP,{}),(0,s.jsx)(N,{children:(0,s.jsx)(eO,{children:(0,s.jsx)(tB.Provider,{value:e,children:(0,s.jsx)(tH.Provider,{value:t,children:(0,s.jsx)(ta.Provider,{value:n,children:(0,s.jsx)(ti.Provider,{value:(e,t)=>{(n||t)&&e||setTimeout(()=>window.dispatchEvent(new Event("resize")),0),r(e)},children:(0,s.jsx)(np,{})})})})})})})]})})}}},function(e){e.O(0,[316,971,938,744],function(){return e(e.s=46919)}),_N_E=e.O()}]);