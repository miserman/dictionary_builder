(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{46919:function(e,t,s){Promise.resolve().then(s.bind(s,78072))},78072:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return t8}});var n=s(57437),r=s(98595),i=s(33948),a=s(3857),l=s(2265),o=s(48123),c=s(60502),d=s(13457),u=s(43226),h=s(35266),m=s(69299),x=s(8864),p=s(6882);let y=/[\r\n]+/,g=/\*/,f=/\*/g,j=/([\[\]\(\)*?^$.+])/g,Z=/^;|;$/g,v=/([\[\]\(\)?^$.+])/g;function b(e){return";"+e.replace(v,"\\$&").replace(f,"[^;]*")+";"}function C(e,t){return e.length-t.length}function _(e,t){return t&&-1!==e?(1-e/t)*100:0}let k=/\./g;function w(e){return";"+e.replace(k,"[^;]")+";"}let S=/^.*[/\\]/;function E(e){return e.replace(S,"")}let z=(0,l.createContext)({}),N=[{key:"terms",label:"Terms"},{key:"termAssociations",label:"Term Associations"},{key:"sense_keys",label:"Sense Keys"},{key:"synsetInfo",label:"Synset Info"}];function O(e){let{children:t}=e,[s,r]=(0,l.useState)(),[i,a]=(0,l.useState)(),[g,f]=(0,l.useState)(),[j,Z]=(0,l.useState)(),[v,b]=(0,l.useState)(),[C,_]=(0,l.useState)(),[k,w]=(0,l.useState)(),[S,E]=(0,l.useState)(!0),[O,P]=(0,l.useState)(!0),[F,T]=(0,l.useState)(!0),[M,A]=(0,l.useState)(!0);(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/terms.txt").then(e=>e.text()).then(e=>{let t=Object.freeze(e.split(y));r(t);let s={all:";;"+t.join(";;")+";;"},n={};t.forEach((e,t)=>{n[e]=t;let r=e[0];r&&(r in s?s[r]+=e+";;":s[r]=";;"+e+";;")}),f(Object.freeze(n)),Z(Object.freeze(s))}).finally(()=>E(!1))},[E]),(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/term_associations.json").then(e=>e.json()).then(e=>{b(e)}).finally(()=>P(!1))},[P]),(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/sense_keys.txt").then(e=>e.text()).then(e=>{_(Object.freeze(e.split(y)))}).finally(()=>T(!1))},[T]),(0,l.useEffect)(()=>{fetch("/dictionary_builder/data/synset_info.json").then(e=>e.json()).then(e=>{w(e.map((e,t)=>(e.index=t,e)))}).finally(()=>A(!1))},[A]),(0,l.useEffect)(()=>{if(s&&v){let e={};v.forEach((t,n)=>{if(t.length){let r=t[0],i="number"==typeof r?r:r.length?r[0]:0;if(i){let t=s[n],r=s[i-1],a=e[r];a&&"function"!=typeof a?"number"==typeof a?e[r]=[i-1,a,n]:a.push(n):e[r]=[i-1,n],e[t]=i-1}}}),a(e)}},[s,v]);let I=(0,l.useMemo)(()=>({terms:s,lemmas:i,termLookup:g,collapsedTerms:j,termAssociations:v,sense_keys:C,synsetInfo:k}),[s,i,g,j,v,C,k]),D={terms:S,termAssociations:O,sense_keys:F,synsetInfo:M};return(0,n.jsx)(z.Provider,{value:I,children:i&&k?t:(0,n.jsxs)(d.Z,{sx:{margin:"auto",marginTop:10,maxWidth:350},children:[(0,n.jsx)(u.Z,{variant:"h4",children:"Loading Resources..."}),(0,n.jsx)(h.Z,{children:N.map(e=>{let{key:t,label:s}=e;return(0,n.jsxs)(m.ZP,{dense:!0,children:[(0,n.jsx)(x.Z,{sx:{minWidth:"35px",mb:1},children:I[t]?(0,n.jsx)(o.Z,{color:"success"}):D[t]?(0,n.jsx)(p.Z,{size:"1.5rem"}):(0,n.jsx)(c.Z,{color:"error",sx:{marginBottom:-.8}})}),(0,n.jsxs)(u.Z,{children:[I[t]||D[t]?"":"Failed to load ",s]})]},t)})})]})})}var P=s(68457),F=s(14262),T=s(52653),M=s(64111),A=s(15133),I=s(26114),D=s(88469),W=s(21975),R=s(88956),L=s(49050),q=s(89394),J=s(91797),K=s(26337),H=s(42834);function B(e){let{label:t,message:s,onConfirm:r}=e,[i,a]=(0,l.useState)(!1),o=()=>a(!i);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L.Z,{fullWidth:!0,color:"error",onClick:o,children:t}),i&&(0,n.jsxs)(q.Z,{open:i,onClose:o,children:[(0,n.jsx)(J.Z,{children:"Confirm"}),(0,n.jsx)(T.Z,{"aria-label":"close export menu",onClick:o,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,n.jsx)(F.Z,{})}),(0,n.jsx)(K.Z,{children:(0,n.jsx)(u.Z,{children:s})}),(0,n.jsxs)(H.Z,{sx:{justifyContent:"space-between"},children:[(0,n.jsx)(L.Z,{onClick:o,children:"Cancel"}),(0,n.jsx)(L.Z,{variant:"contained",color:"error",onClick:()=>{r(),o()},children:t})]})]})]})}let $="30vh",G="200px";function Y(){return JSON.parse(localStorage.getItem("dictionary_builder_settings")||"{}")}function V(){let[e,t]=(0,l.useState)(!1),s=()=>t(!e),r=(0,l.useMemo)(Y,[]),i=(0,l.useContext)(th),[a,o]=(0,l.useState)(r.undo||"z"),[c,h]=(0,l.useState)(r.redo||"x"),m=(0,l.useCallback)(e=>{!e.ctrlKey&&!e.metaKey||e.target&&"tagName"in e.target&&"INPUT"===e.target.tagName||(e.key===c?i(-1):e.key===a&&i(1))},[a,c,i]);return(0,l.useEffect)(()=>(window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}),[m]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.Z,{onClick:s,"aria-label":"toggle settings menu",children:(0,n.jsx)(P.Z,{})}),(0,n.jsx)(M.ZP,{anchor:"right",open:e,onClose:s,children:(0,n.jsxs)(A.Z,{sx:{height:"100%",width:"12em",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,n.jsx)(I.Z,{title:(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Settings"}),action:(0,n.jsx)(T.Z,{onClick:s,"aria-label":"close settings menu",className:"close-button",children:(0,n.jsx)(F.Z,{})})}),(0,n.jsxs)(D.Z,{sx:{alignContent:"left",mb:"auto"},children:[(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Keybinds"}),(0,n.jsx)(u.Z,{variant:"caption",children:"CTRL + "}),(0,n.jsxs)(d.Z,{spacing:2,sx:{mt:1},children:[(0,n.jsx)(W.Z,{size:"small",label:"undo",value:a,onChange:e=>{window.removeEventListener("keydown",m),r.undo=e.target.value,localStorage.setItem("dictionary_builder_settings",JSON.stringify(r)),o(e.target.value)}}),(0,n.jsx)(W.Z,{size:"small",label:"redo",value:c,onChange:e=>{window.removeEventListener("keydown",m),r.redo=e.target.value,localStorage.setItem("dictionary_builder_settings",JSON.stringify(r)),h(e.target.value)}})]})]}),(0,n.jsx)(R.Z,{children:(0,n.jsx)(B,{label:"Clear Storage",message:"Clearing storage will delete all settings, dictionaries, and edit history.",onConfirm:()=>{let e=Y();e.dictionary_names&&e.dictionary_names.forEach(e=>{localStorage.removeItem("dict_"+e),localStorage.removeItem("dict_history_"+e)}),localStorage.removeItem("dictionary_builder_settings"),window.location.reload()}})})]})})]})}var U=s(72502),X=s(38212),Q=s(7154),ee=s(19093),et=s(39657);function es(){let e=(0,l.useContext)(td),t=(0,l.useContext)(tu),s=(0,l.useContext)(th),r=(0,l.useMemo)(()=>e.edits.map((t,r)=>(0,n.jsx)(m.ZP,{sx:{p:0},children:(0,n.jsx)(U.Z,{sx:{borderLeft:e.position>=r?"2px solid #fff":""},onClick:()=>s(r-e.position),children:(0,n.jsx)(X.Z,{sx:{m:0},primary:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(u.Z,{children:[(0,n.jsx)("span",{style:{opacity:".75"},children:t.type+": "}),t.name]}),"edit_term"===t.type?(0,n.jsx)(u.Z,{className:"code",sx:{wordBreak:"break-all"},children:"categories"===t.value.field?t.value.edits.map(e=>e.category+": "+e.from+" -> "+e.to).join("\n"):t.value.field+": "+t.value.original+" -> "+t.value.new}):"rename_category"===t.type?(0,n.jsxs)(u.Z,{className:"code",children:["From ",t.originalName]}):(0,n.jsx)(n.Fragment,{})]}),secondary:(0,n.jsx)(u.Z,{sx:{fontSize:".8em",opacity:.6},variant:"body2",children:t.time?new Date(t.time).toLocaleString():""})})})},r)),[e,s]);return(0,n.jsxs)(A.Z,{elevation:5,sx:{height:"60%",minHeight:"300px",position:"relative",display:"flex",flexDirection:"column"},children:[(0,n.jsx)(I.Z,{title:(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Edit History"}),sx:{pb:0}}),(0,n.jsxs)(d.Z,{direction:"row",sx:{position:"absolute",top:8,right:8},children:[(0,n.jsx)(T.Z,{onClick:()=>s(1),"aria-label":"undo",children:(0,n.jsx)(Q.Z,{})}),(0,n.jsx)(T.Z,{onClick:()=>s(-1),"aria-label":"redo",children:(0,n.jsx)(ee.Z,{})}),(0,n.jsx)(T.Z,{onClick:()=>s(-1e3),"aria-label":"jump to current",children:(0,n.jsx)(et.Z,{})})]}),(0,n.jsx)(D.Z,{sx:{p:0,mb:"auto",overflowY:"auto"},children:(0,n.jsx)(h.Z,{sx:{overflowX:"hidden"},children:r})}),(0,n.jsx)(R.Z,{children:(0,n.jsx)(L.Z,{fullWidth:!0,onClick:()=>{t({type:"clear"})},children:"Clear"})})]})}var en=s(79245),er=s(39350),ei=s(40471),ea=s(1664),el=s(38639),eo=s(74309),ec=s(78276),ed=s(30666),eu=s(15795),eh=s(73701),em=s(66988),ex=s(98489),ep=s(39279),ey=s(27449),eg=s(25210);function ef(e){let{senseKey:t,info:s}=e,r=(0,l.useContext)(eF);return(0,n.jsx)(ec.Z,{title:s.definition,placement:"right",children:(0,n.jsx)(eg.Z,{underline:"none",sx:{p:0,justifyContent:"flex-start",cursor:"pointer",display:"block"},onClick:()=>r({type:"add",state:{type:"synset",value:t,info:s}}),children:t})})}function ej(e,t){return Array.isArray(e)?e.map(e=>t[e-1]):[t[e-1]]}function eZ(e){let{name:t,info:s}=e,r=s[t],i=(0,l.useContext)(ta),a=(0,l.useContext)(tl),o=(0,l.useContext)(eF),{terms:c,sense_keys:d,synsetInfo:m}=(0,l.useContext)(z);return c&&d&&m?(0,n.jsxs)(en.Z,{sx:{m:1},children:[(0,n.jsx)(u.Z,{variant:"h5",children:t}),(0,n.jsx)(h.Z,{children:"string"==typeof r?r:"members"===t?c?Array.isArray(r)?r.map(e=>eV(c[e-1],i,a,o)):eV(c[r-1],i,a,o):(0,n.jsx)(n.Fragment,{}):Array.isArray(r)?r.map(e=>{let t=m[e-1];return(0,n.jsx)(ef,{senseKey:d[e-1],info:t},e)}):(0,n.jsx)(ef,{senseKey:d[r-1],info:m[r-1]})})]},t):(0,n.jsx)(n.Fragment,{})}let ev={id:0,index:0,ili:0,definition:0,topic:0},eb={a:"adj",r:"adv",s:"adj",n:"noun",v:"verb"};function eC(e){let{info:t}=e,{sense_keys:s}=(0,l.useContext)(z);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{variant:"h6",children:t.definition}),(0,n.jsxs)(d.Z,{direction:"row",spacing:2,children:[(0,n.jsxs)(en.Z,{children:[(0,n.jsxs)(u.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Open English WordNet ID: ",(0,n.jsx)("span",{className:"number",children:t.id})]}),(0,n.jsxs)(u.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Sense Key: ",(0,n.jsx)("span",{className:"number",children:s&&s[t.index]})]}),(0,n.jsxs)(u.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Interlingual ID: ",(0,n.jsx)("span",{className:"number",children:t.ili})]})]}),(0,n.jsxs)(en.Z,{children:[(0,n.jsxs)(u.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Part of Speech:"," ",(0,n.jsx)("span",{className:"number",children:eb[t.id.substring(t.id.length-1)]})]}),(0,n.jsxs)(u.Z,{component:"p",variant:"caption",sx:{ml:1},children:["Topic: ",(0,n.jsx)("span",{className:"number",children:t.topic})]})]})]}),(0,n.jsx)(d.Z,{direction:"row",sx:{mt:2},children:Object.keys(t).filter(e=>!(e in ev)).map(e=>(0,n.jsx)(eZ,{name:e,info:t},e))})]})}var e_=s(84081),ek=s(2510),ew=s(40182),eS=s(88444),eE=s(85207);let ez=(0,l.createContext)(""),eN=(0,l.createContext)((e,t)=>{});function eO(e){let{categories:t,editor:s}=e,r=(0,l.useContext)(z),i=(0,l.useContext)(ta),a=(0,l.useContext)(ez),o=(0,l.useContext)(eN),[c,h]=(0,l.useState)(!1);if(!a||!(a in i))return(0,n.jsx)(n.Fragment,{});let m=e7(a,r,i),x=i[a],p=(0,l.useMemo)(()=>[{field:"id",headerName:"Name",width:110},{field:"from_term_editor",headerName:"Weight",width:65,editable:!0,hideable:!1,valueParser:(e,t)=>{let n=+e||"";return t&&s(n,t),n}}],[]),y=x.categories,g=[];return t.forEach(e=>{(c||e in y)&&g.push({id:e,from_term_editor:y[e]||"",dictEntry:x,processed:m})}),(0,n.jsx)(en.Z,{sx:{position:"absolute",top:0,right:"-"+G,height:"100%",width:G},children:(0,n.jsxs)(A.Z,{sx:{height:"100%",pb:"2.5em"},elevation:1,children:[(0,n.jsx)(I.Z,{action:(0,n.jsx)(T.Z,{"aria-label":"Close term editor",onClick:()=>o(""),className:"close-button",children:(0,n.jsx)(F.Z,{})}),title:(0,n.jsx)(u.Z,{fontWeight:"bold",sx:{whiteSpace:"nowrap"},children:(0,n.jsx)(eX,{term:m.term})})}),(0,n.jsx)(D.Z,{sx:{p:.5,height:"100%"},children:(0,n.jsxs)(d.Z,{direction:"column",sx:{height:"100%"},children:[(0,n.jsxs)(e_.Z,{sx:{mb:3},children:["fuzzy"!==m.type&&m.synsets.length?(0,n.jsx)(ek.Z,{sx:{mt:x.sense?"":"-7px"},id:"term_editor_sense",children:"Sense"}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)(eH,{labelId:"term_editor_sense",label:"Sense",id:"",field:"",processed:m})]}),(0,n.jsxs)(d.Z,{direction:"column",spacing:1,sx:{height:"100%"},children:[(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Category Weights"}),(0,n.jsx)(ew.Z,{control:(0,n.jsx)(eS.Z,{size:"small",checked:c,onChange:()=>h(!c)}),label:(0,n.jsx)(u.Z,{variant:"caption",children:"Show Empty"}),labelPlacement:"start"}),(0,n.jsx)(eE._$,{className:"datagrid-vertical",rows:g,columns:p,disableRowSelectionOnClick:!0,disableDensitySelector:!0,disableColumnMenu:!0,pageSizeOptions:[100],density:"compact",onCellKeyDown:(e,t)=>{("Delete"===t.key||"Backspace"===t.key)&&s(0,e)}})]})]})})]})})}let eP=(0,l.createContext)([]),eF=(0,l.createContext)(e=>{});function eT(e){let{term:t}=e,s=(0,l.useContext)(ta),r=(0,l.useContext)(tl),i=t in s;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(D.Z,{sx:{overflowY:"auto",pb:0,pt:0},children:(0,n.jsx)(eQ,{term:t})}),(0,n.jsx)(R.Z,{sx:{justifyContent:"flex-end",mt:"auto"},children:(0,n.jsx)(L.Z,{onClick:()=>{r(i?{type:"remove",term:t}:{type:"add",term:t,term_type:"fixed"})},children:i?"Remove":"Add"})})]})}function eM(e){let{info:t}=e;return(0,n.jsx)(D.Z,{sx:{overflowY:"auto",mb:"auto",pt:0},children:(0,n.jsx)(eC,{info:t})})}function eA(){let e=(0,l.useContext)(ta),t=(0,l.useContext)(eF),s=(0,l.useContext)(eN),r=(0,l.useContext)(eP);if(!r.length)return;let i=()=>{t({type:"reset"})},a=r[0];return(0,n.jsx)(M.ZP,{open:""!==a.value,onClose:i,variant:"permanent",hideBackdrop:!0,anchor:"bottom",sx:{"& .MuiPaper-root":{height:$,display:"flex",flexDirection:"column",justifyContent:"space-between"}},children:(0,n.jsxs)(A.Z,{children:[(0,n.jsx)(I.Z,{action:(0,n.jsx)(T.Z,{"aria-label":"Close info drawer",onClick:i,className:"close-button",children:(0,n.jsx)(F.Z,{})}),title:(0,n.jsxs)(d.Z,{direction:"row",children:[r.length>1?(0,n.jsx)(L.Z,{onClick:()=>t({type:"back"}),sx:{opacity:.8},children:r[1].value}):(0,n.jsx)(n.Fragment,{}),a.value in e?(0,n.jsx)(L.Z,{sx:{textTransform:"none",p:0},onClick:()=>s(a.value),children:(0,n.jsx)(u.Z,{variant:"h3",children:a.value})}):(0,n.jsx)(u.Z,{variant:"h3",children:a.value})]})}),"term"===a.type?(0,n.jsx)(eT,{term:a.value}):(0,n.jsx)(eM,{info:a.info})]})})}let eI=/[aeiouy]$/;function eD(e,t){let s,n;let r=new Set,i=(e=e.replace(j,"\\$&")).length;try{s=i>3?RegExp(";(?:anti|de|dis|central|en|ex|faux|hyper|il|ill|in|intra|inter|ir|meso|mal|mid|middle|mis|miss|non|over|pan|post|pre|pro|re|retro|sudo|sub|super|un|uber|under|ultra|trans)?-?"+e+(eI.test(e)?"*":"+")+"-?(?:'|ac|age|al|alize|ance|ancy|ant|ary|at|ate|ation|cracy|cy|cycle|d|dom|ed|ence|ency|ent|er|es|esque|est|ette|ey|ful|hood|ial|ic|ie|ies|ify|in|ing|ion|ionate|isation|ish|ise|ism|ist|ive|ize|ization|let|lets|lette|like|ling|lings|log|ly|ley|ment|n|nce|ness|ng|nt|or|on|ous|r|s|ship|st|t|th|ties|ty|ur|ward|wise|y|z)?(?:'|al|alize|alization|ate|ation|ble|d|ed|er|es|ility|in|ing|ion|ise|isation|ish|ize|ization|ly|ness|ous|s|y|z)?;","g"):RegExp(";(?:de|un|re)?-?"+(i>2?e.replace(eI,"[aeiouy]"):e)+"+-?(?:'|d|ed|er|en|ing|s|y)?;","g")}catch(e){}if(s)for(;n=s.exec(t);){let t=n[0];t&&t.length-1>i&&";"+e+";"!==t&&r.add(t.replace(Z,""))}return Array.from(r)}var eW=s(91600),eR=s(4351),eL=s(21885),eq=s(94749),eJ=s(68368),eK=s(33249);function eH(e){let{id:t,field:s,processed:r,label:i,labelId:a,editCell:o}=e,c=(0,l.useContext)(ta),d=(0,l.useContext)(tl),h=c[r.term].sense,{sense_keys:m}=(0,l.useContext)(z);return"fixed"===r.type&&r.synsets.length?(0,n.jsx)(el.Z,{fullWidth:!0,size:"small","aria-label":"assign synset",value:h,onChange:e=>{o&&o({id:t,field:s,value:e.target.value}),d({type:"update",term:r.term,term_type:r.term_type,sense:e.target.value})},label:i,labelId:a,children:m&&r.synsets.map(e=>{let{index:t}=e;return(0,n.jsx)(eo.Z,{value:m[t],children:(0,n.jsx)(ec.Z,{title:e.definition,placement:"right",children:(0,n.jsx)(u.Z,{sx:{width:"100%"},children:m[t]})})},t)})}):(0,n.jsx)(W.Z,{size:"small",value:h,onChange:e=>{o&&o({id:t,field:s,value:e.target.value}),d({type:"update",term:r.term,term_type:r.term_type,sense:e.target.value})},label:i})}let eB=["Match","Frequency","Senses","Related","In Dictionary"],e$={position:"absolute",fontSize:"1.5em",height:"1.2em",opacity:.4};function eG(e){let{processed:t}=e,s=(0,l.useContext)(ta),r=(0,l.useContext)(tl),i=(0,l.useContext)(z),[a,o]=(0,l.useState)(0),[c,d]=(0,l.useState)(5),[h,m]=(0,l.useState)({column:"Frequency",asc:!1}),x=(0,l.useMemo)(()=>[(0,n.jsx)(ed.Z,{width:1},"term_action"),...eB.map(e=>(0,n.jsxs)(ed.Z,{width:"Match"===e?999:1,component:"th",align:"Match"===e?"left":"right",sx:{cursor:"pointer",pr:3},onClick:()=>{m(h.column===e&&h.asc?{column:"Frequency",asc:!1}:{column:e,asc:h.column===e})},children:[e,h.column===e?h.asc?(0,n.jsx)(eW.Z,{sx:e$}):(0,n.jsx)(eR.Z,{sx:e$}):(0,n.jsx)(n.Fragment,{})]},e))],[m,h]),p=t.matches.length,y=(0,l.useMemo)(()=>t.matches.map(e=>{let t=e7(e,i);return t.frequency=_(t.index,i.terms&&i.terms.length),t.in_dict=t.term in s,t}),[t,i,s]);if(a>p/c)return o(0),(0,n.jsx)(n.Fragment,{});y.sort(function(e){let{column:t,asc:s}=e;switch(t){case"Match":return s?(e,t)=>e.term>t.term?-1:1:(e,t)=>t.term>e.term?-1:1;case"Frequency":return s?(e,t)=>(e.frequency||0)-(t.frequency||0):(e,t)=>(t.frequency||0)-(e.frequency||0);case"Senses":return s?(e,t)=>e.synsets.length-t.synsets.length:(e,t)=>t.synsets.length-e.synsets.length;case"Related":return s?(e,t)=>e.related.length-t.related.length:(e,t)=>t.related.length-e.related.length;case"In Dictionary":return s?(e,t)=>(e.in_dict||0)>(t.in_dict||0)?-1:1:(e,t)=>(t.in_dict||0)>(e.in_dict||0)?-1:1}}(h));let g=[];if(p)for(let e=a*c,t=Math.min(y.length,e+c);e<t;e++)g.push(y[e]);if(!t.common_matches){let e="";t.matches.forEach(t=>{(!e||t.length<e.length)&&(e=t)}),t.common_matches=eD(e,";;"+t.matches.join(";;")+";;")}return(0,n.jsx)(en.Z,{sx:{height:"100%",overflowY:"auto"},children:p?(0,n.jsxs)(eu.Z,{sx:{height:"100%"},children:[(0,n.jsxs)(eh.Z,{stickyHeader:!0,size:"small",sx:{width:"100%","& .MuiTableCell-root:first-of-type":{pl:1}},children:[(0,n.jsx)(em.Z,{children:(0,n.jsx)(ex.Z,{children:x})}),(0,n.jsx)(ep.Z,{children:g.map((e,t)=>{let s=e.term;return(0,n.jsxs)(ex.Z,{sx:{height:33},hover:!0,children:[(0,n.jsx)(ed.Z,{sx:{p:0},children:e.in_dict?(0,n.jsx)(T.Z,{"aria-label":"remove",size:"small",edge:"start",sx:{p:0,opacity:.6},onClick:()=>{r({type:"remove",term:s})},children:(0,n.jsx)(eL.Z,{})}):(0,n.jsx)(T.Z,{"aria-label":"add",size:"small",edge:"start",sx:{p:0,opacity:.6},onClick:()=>{r({type:"add",term:s,term_type:"fixed"})},children:(0,n.jsx)(eq.Z,{})})}),(0,n.jsx)(ed.Z,{children:(0,n.jsx)(eX,{term:s})}),(0,n.jsx)(ed.Z,{align:"right",children:e.frequency&&e.frequency.toFixed(2)||"0.00"}),(0,n.jsx)(ed.Z,{align:"right",children:e.synsets.length}),(0,n.jsx)(ed.Z,{align:"right",children:e.related.length}),(0,n.jsx)(ed.Z,{align:"right",children:e.in_dict?"yes":"no"})]},s+t)})})]}),(0,n.jsx)(ey.Z,{component:"div",rowsPerPageOptions:[5,10,50,100,1e3],count:p,rowsPerPage:c,page:a,onPageChange:(e,t)=>{o(t)},onRowsPerPageChange:e=>{d(parseInt(e.target.value)),o(0)}})]}):(0,n.jsx)(u.Z,{children:"No matches"})})}let eY={minWidth:"20px",opacity:.9,"& .MuiSvgIcon-root":{fontSize:"1em"}};function eV(e,t,s,r){let i=e in e4?e4[e]:"",a=e in t;return(0,n.jsxs)(m.ZP,{disableGutters:!0,disablePadding:!0,sx:{pr:3},secondaryAction:a?(0,n.jsx)(T.Z,{"aria-label":"remove",size:"small",edge:"end",sx:eY,onClick:()=>{s({type:"remove",term:e})},children:(0,n.jsx)(eL.Z,{})}):(0,n.jsx)(T.Z,{"aria-label":"add",size:"small",edge:"end",sx:eY,onClick:()=>{s({type:"add",term:e,term_type:"fixed"})},children:(0,n.jsx)(eq.Z,{})}),children:[(0,n.jsx)(x.Z,{sx:eY,children:a?(0,n.jsx)(ec.Z,{title:"in current dictionary",placement:"left",children:(0,n.jsx)(eJ.Z,{color:"success"})}):i&&i in t?(0,n.jsx)(ec.Z,{title:"captured by "+i+" in current dictionary",placement:"left",children:(0,n.jsx)(T.Z,{sx:{p:0,"& .MuiSvgIcon-root":{fontSize:".7em"}},onClick:()=>{r({type:"add",state:{type:"term",value:i}})},children:(0,n.jsx)(eK.Z,{color:"secondary"})})}):(0,n.jsx)(n.Fragment,{})}),(0,n.jsx)(eX,{term:e})]},e)}function eU(e){let{processed:t}=e,s={p:1,pl:0,maxHeight:"100%",overflowY:"auto",overflowX:"hidden"},r=(0,l.useContext)(ta),i=(0,l.useContext)(tl),a=(0,l.useContext)(eF),{terms:o,termLookup:c,collapsedTerms:x,sense_keys:p}=(0,l.useContext)(z),y=(0,l.useCallback)(c?(e,t)=>c[e]-c[t]:()=>0,[c]);return t.forms||(t.forms=eD(t.term,x?x.all:""),t.forms.sort(C)),(0,n.jsxs)(d.Z,{direction:"row",spacing:4,sx:{height:"100%"},children:[(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(ec.Z,{title:"100 - index / n terms * 100; terms are loosely sorted by frequency and space coverage",children:(0,n.jsx)(u.Z,{children:"Relative Frequency"})}),(0,n.jsx)(en.Z,{sx:{p:1},children:(0,n.jsx)("span",{className:"number",children:_(t.index,o&&o.length).toFixed(2)})})]}),o&&t.lemma.length?(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{children:"Lemmatizer"}),(0,n.jsx)(en.Z,{sx:s,children:(0,n.jsx)(h.Z,{disablePadding:!0,sx:{p:0},children:t.lemma.filter(e=>e!==t.term).map(e=>eV(e,r,i,a))})})]}):(0,n.jsx)(n.Fragment,{}),t.forms.length?(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{children:"Expansion"}),(0,n.jsx)(en.Z,{sx:s,children:(0,n.jsx)(h.Z,{disablePadding:!0,sx:{p:0},children:t.forms.map(e=>eV(e,r,i,a))})})]}):(0,n.jsx)(n.Fragment,{}),t.related.length?(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{children:"Related Terms"}),(0,n.jsx)(en.Z,{sx:s,children:(0,n.jsx)(h.Z,{disablePadding:!0,sx:{p:0},children:t.related.map(e=>eV(e,r,i,a))})})]}):(0,n.jsx)(n.Fragment,{}),p&&t.synsets.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{children:"Senses"}),(0,n.jsx)(en.Z,{sx:s,children:(0,n.jsx)(h.Z,{sx:{p:0},children:t.synsets.map(e=>(0,n.jsx)(m.ZP,{disablePadding:!0,children:(0,n.jsx)(ef,{senseKey:p[e.index],info:e})},e.index))})})]}),t.synset_terms.length?(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{children:"Extended Synset Members"}),(0,n.jsx)(en.Z,{sx:s,children:(0,n.jsx)(h.Z,{disablePadding:!0,sx:{p:0},children:t.synset_terms.sort(y).map(e=>eV(e,r,i,a))})})]}):(0,n.jsx)(n.Fragment,{})]}):(0,n.jsx)(n.Fragment,{})]})}function eX(e){let{term:t}=e,s=(0,l.useContext)(eF);return(0,n.jsx)(L.Z,{fullWidth:!0,variant:"text",sx:{p:0,justifyContent:"flex-start",textTransform:"none"},onClick:()=>s({type:"add",state:{type:"term",value:t}}),children:t})}function eQ(e){let{term:t}=e,s=e7(t,(0,l.useContext)(z),(0,l.useContext)(ta));return"fixed"===s.type?(0,n.jsx)(eU,{processed:s}):(0,n.jsx)(eG,{processed:s})}var e0=s(22750);let e1={dictionary:0,comparisons:0};function e2(e,t){return t.dictEntry.added-e.dictEntry.added}function e3(e){let{editFromEvent:t}=e,s=(0,l.useContext)(z),r=(0,l.useContext)(ta),i=(0,l.useContext)(to),a=(0,l.useContext)(tl),o=(0,l.useMemo)(()=>Object.freeze(Object.keys(r).sort()),[r]),c=(0,l.useMemo)(()=>{let e=[{field:"remove",headerName:"",width:1,sortable:!1,disableColumnMenu:!0,renderCell:e=>(0,n.jsx)(T.Z,{sx:{opacity:.4,cursor:"not-allowed"},size:"small","aria-label":"remove term",onClick:()=>{a({type:"remove",term:e.id})},children:(0,n.jsx)(ea.Z,{sx:{fontSize:".9em"}})})},{field:"id",headerName:"Term",renderCell:e=>(0,n.jsx)(eX,{term:e.value})},{field:"sense",headerName:"Sense",description:"assigned sense key",editable:!0,renderEditCell:e=>(0,n.jsx)(eH,{id:e.id,field:e.field,processed:e.row.processed,editCell:e.api.setEditCellValue})},{field:"frequency",headerName:"Frequency",description:"relative frequency; 100 - index / n terms * 100; terms are loosely sorted by frequency and space coverage"},{field:"matches",headerName:"Matches",description:"number of matches found in the full term list"},{field:"senses",headerName:"Senses",description:"number of directly associated senses"},{field:"related",headerName:"Related",description:"number of similar terms on record, based on agreement between embeddings spaces"},{field:"ncats",headerName:"Categories",description:"number of categories the term has weight in"}];return i.forEach(s=>e.push({field:"category_"+s,headerName:s,editable:!0,valueParser:(e,s)=>{let n=+e||"";return s&&t(n,s),n}})),e},[i,t]),[h,m]=(0,l.useState)([]),[x,p]=(0,l.useState)(0);(0,l.useEffect)(()=>{s.termAssociations&&s.synsetInfo&&tt(r,s,p).then(e=>{m(e.sort(e2)),p(0)})},[r,s]);let y=(0,l.useMemo)(()=>{if(o.length<1e3)return!1;let e=h.map(e=>{let{id:t}=e;return t}).sort();return!(2>Math.abs(e.length-o.length))&&e.join()!==o.join()},[h,o]),g=(0,l.useContext)(eN);return(0,n.jsx)(en.Z,{component:"main",sx:{height:"100%"},children:o.length?y?(0,n.jsx)(er.Z,{open:!0,children:(0,n.jsxs)(d.Z,{direction:"column",sx:{textAlign:"center"},children:[(0,n.jsx)(u.Z,{variant:"h4",children:"Processing Dictionary"}),(0,n.jsx)(ei.Z,{variant:"determinate",value:100*x}),(0,n.jsx)(u.Z,{variant:"caption",children:x?Math.round(100*x)+"%":"preparing..."})]})}):(0,n.jsx)(eE._$,{sx:{"& .MuiFormControl-root":{position:"absolute",bottom:"4px",left:"12px"}},rows:h,columns:c,showCellVerticalBorder:!0,disableDensitySelector:!0,pageSizeOptions:[100],density:"compact",slots:{toolbar:e0.T},onCellKeyDown:(e,s)=>{("Delete"===s.key||"Backspace"===s.key)&&t(0,e)},onRowClick:e=>{let{row:t}=e;g(t.id)}}):(0,n.jsx)(u.Z,{align:"center",children:"Add terms, or import an existing dictionary."})})}let e5={},e4={};async function e8(e,t,s){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,i=s[t.source[1]in s?t.source[1]:"all"];for(let s,a="";n.length<r&&(s=t.exec(i));)(a=s[0].replace(Z,""))&&(n.push(a),!e||a in e4||(e4[a]=e))}function e9(e,t,s){Object.keys(s).forEach(s=>{e[s]=!0,t[s]=!0})}function e6(e,t){try{return new RegExp(e,t)}catch(t){return e}}function e7(e,t,s,n){let r=s&&e in s&&"regex"===s[e].type?"regex":"fixed",i=e+"_"+r;i in e5||(e5[i]=function(e,t){let s="string"==typeof e;if(s&&!g.test(e))return function(e,t){let{terms:s,lemmas:n,termLookup:r,termAssociations:i,synsetInfo:a}=t,l={type:"fixed",term:e,term_type:"fixed",categories:{},recognized:!1,index:s&&r&&r[e]||-1,lemma:[],related:[],synsets:[],synset_terms:[],lookup:{expanded:!1,map:new Map,any:{},lemma:{},lemma_related:{},lemma_synset:{},related:{},related_lemma:{},related_related:{},related_synset:{},synset:{},synset_lemma:{},synset_related:{},synset_synset:{}}};if(i&&a&&n&&s&&-1!==l.index){l.recognized=!0;let t=i[l.index];l.related=t&&t[0]&&Array.isArray(t[0])?t[0].filter((e,t)=>!!t).map(e=>s[e-1]):[],l.synsets=t&&t[1]?(Array.isArray(t[1])?t[1]:[t[1]]).map(e=>a[e-1]):[];let r=new Set;l.synsets.forEach(e=>{(function(e,t,s){let n=new Set(ej(e.members,t));return Object.keys(e).forEach(r=>{if("members"!==r&&"index"!==r){var i;(Array.isArray(i=e[r])?"number"==typeof i[0]?i.map(e=>s[e-1]):[]:"number"==typeof i?[s[i-1]]:[]).forEach(e=>{ej(e.members,t).forEach(e=>n.add(e))})}}),Array.from(n)})(e,s,a).forEach(e=>{e!==l.term&&r.add(e)})}),l.synset_terms=Array.from(r);let o=s&&n&&e in n?n["number"==typeof n[e]?s[n[e]]:e]:[];l.lemma="number"==typeof o?[s[o]]:o.map(e=>s[e]),l.lemma.forEach(e=>{l.lookup.any[e]=!0,l.lookup.lemma[e]=!0}),l.related.forEach(e=>{l.lookup.any[e]=!0,l.lookup.related[e]=!0}),l.synset_terms.forEach(e=>{l.lookup.any[e]=!0,l.lookup.synset[e]=!0})}return l}(e,t);{let n=s?b(e):e.source,r={type:"fuzzy",term_type:s?"glob":"regex",term:s?e:e.source,categories:{},recognized:!1,regex:e6(s?n:w(n),"g"),matches:[]};return t.collapsedTerms&&e8(r.term,r.regex,t.collapsedTerms,r.matches),r.recognized=!!r.matches.length,r}}("regex"===r?e6(e):e,t));let a=e5[i];return n&&"fixed"===a.type&&!a.lookup.expanded&&function(e,t){let s=e.lookup,n=s.any;e.lemma.forEach(e=>{let r=e7(e,t).lookup;e9(n,s.lemma_related,r.related),e9(n,s.lemma_synset,r.synset)}),e.related.forEach(e=>{let r=e7(e,t).lookup;e9(n,s.related_lemma,r.lemma),e9(n,s.related_related,r.related),e9(n,s.related_synset,r.synset)}),e.synset_terms.forEach(e=>{let r=e7(e,t).lookup;e9(n,s.synset_lemma,r.lemma),e9(n,s.synset_related,r.related),e9(n,s.synset_synset,r.synset)}),s.expanded=!0,s.map=new Map(Object.keys(n).map(e=>[e,!0]))}(a,t),a}async function te(e,t,s,n,r){let i=e7(s,r,n),a=n[s],l="fixed"===i.type?{processed:i,dictEntry:a,id:s,sense:a.sense,matches:i.recognized?1:0,ncats:Object.keys(a.categories).length,frequency:_(i.index,r.terms&&r.terms.length).toFixed(2),senses:i.synsets.length,related:i.related.length}:{processed:i,dictEntry:a,id:s,sense:a.sense,matches:i.matches.length,ncats:Object.keys(a.categories).length};if("fixed"===i.type&&!l.sense&&1===i.synsets.length&&r.sense_keys&&r.synsetInfo&&(l.sense=r.sense_keys[i.synsets[0].index]),a.categories){let e=a.categories;Object.keys(e).forEach(t=>{l["category_"+t]=e[t]})}e[t]=l}async function tt(e,t,s){return clearTimeout(e1.dictionary),new Promise(n=>{let r=Object.freeze(Object.keys(e)),i=r.length,a=Array(i),l=0,o=0,c=()=>{for(clearTimeout(e1.dictionary);l<i&&o<1e3;l++,o++)te(a,l,r[l],e,t);l!==i?(o=0,s(l/i),e1.dictionary=setTimeout(c,0)):(s(1),n(a))};e1.dictionary=setTimeout(c,0)})}let ts=(0,l.createContext)("default"),tn=(0,l.createContext)(e=>{}),tr=(0,l.createContext)({}),ti=(0,l.createContext)(e=>{}),ta=(0,l.createContext)({}),tl=(0,l.createContext)(e=>{}),to=(0,l.createContext)([]),tc=(0,l.createContext)(e=>{}),td=(0,l.createContext)({edits:[],position:-1}),tu=(0,l.createContext)(e=>{}),th=(0,l.createContext)(e=>{});function tm(e,t){return e.toLowerCase()>t.toLowerCase()?1:-1}function tx(e){let{children:t}=e,s=(0,l.useContext)(z),r=(0,l.useMemo)(Y,[]),i=(0,l.useMemo)(()=>{let e={default:{}};return(r.dictionary_names||[]).forEach(t=>{e[t]=JSON.parse(localStorage.getItem("dict_"+t)||"{}")}),e},[r]),[a,o]=(0,l.useState)(r.selected||"default"),c=()=>JSON.parse(localStorage.getItem("dict_history_"+a)||'{"edits": [], "position": -1}'),d=e=>{if("replace"===e.type){h(e.history);return}let t="clear"===e.type?[]:[...u.edits],s="clear"===e.type?-1:u.position;"remove"===e.type?t.pop():"clear"!==e.type&&(s>-1&&(t.splice(0,s+1),s=-1),e.entry.time||(e.entry.time=Date.now()),t.splice(0,0,e.entry)),t.length>1e3&&t.splice(1e3,t.length-999),localStorage.setItem("dict_history_"+a,JSON.stringify({edits:t,position:s})),h({edits:t,position:s})},[u,h]=(0,l.useState)(c()),m=e=>{"delete"===e.type?(delete i[e.name],localStorage.removeItem("dict_"+e.name),localStorage.removeItem("dict_history_"+e.name),"default"===e.name&&(i.default={}),a===e.name&&(y("default"),f({type:"change_dict",dict:i.default}))):("set"!==e.type&&(i[e.name]=e.dict),a&&localStorage.setItem("dict_"+e.name,JSON.stringify(i[a])),"save"!==e.type&&(y(e.name),f({type:"change_dict",dict:i[e.name]})),localStorage.setItem("dict_"+e.name,JSON.stringify(i[e.name]))),r.dictionary_names=Object.keys(i),localStorage.setItem("dictionary_builder_settings",JSON.stringify(r))},[x,p]=(0,l.useReducer)((e,t)=>{switch(t.type){case"collect":let s=new Set(t.reset?[]:e);return Object.keys(t.dictionary).forEach(e=>{let n=t.dictionary[e];n&&n.categories&&Object.keys(n.categories).forEach(e=>s.add(e))}),Array.from(s).sort(tm);case"add":return e.includes(t.cat)?[...e]:[...e,t.cat].sort(tm);default:return e.filter(e=>e!==t.cat)}},[]),y=e=>{let t=e in i?e:"default";o(t),r.selected=t,localStorage.setItem("dictionary_builder_settings",JSON.stringify(r))},[g,f]=(0,l.useReducer)((e,t)=>{if("history_bulk"===t.type)return p({type:"collect",dictionary:t.dict,reset:!0}),m({type:"save",name:a,dict:t.dict}),t.dict;if("change_dict"===t.type)return d({type:"replace",history:c()}),p({type:"collect",dictionary:t.dict,reset:!0}),t.dict;let n={...e};if("rename_category"===t.type){let e=0;Object.keys(n).forEach(s=>{let r=n[s];t.name in r.categories&&(e++,r.categories[t.name]&&(r.categories[t.newName]=r.categories[t.name]),delete r.categories[t.name])}),p({type:"remove",cat:t.name}),p({type:"add",cat:t.newName}),e&&d({type:"add",entry:{type:"rename_category",name:t.newName,originalName:t.name}})}else if("remove_category"===t.type){let e={},s=0;Object.keys(n).forEach(r=>{let i=n[r];t.name in i.categories&&(s++,i.categories[t.name]&&(e[r]=i.categories[t.name]),delete i.categories[t.name])}),s&&d({type:"add",entry:{type:"remove_category",name:t.name,value:e}})}else if("add_category"===t.type)Object.keys(t.weights).forEach(e=>{e in n&&(n[e].categories[t.name]=t.weights[e])}),d({type:"add",entry:{type:"add_category",name:t.name,value:t.weights}});else{let r="string"==typeof t.term?t.term:t.term.source;if("remove"===t.type)delete n[r],d({type:"add",entry:{type:"remove_term",name:r,value:e[r]}});else{let i=n[r]||{};n[r]={added:i.added||Date.now(),type:t.term_type||i.type||"fixed",categories:{...t.categories||i.categories||{}},sense:"sense"in t?t.sense||"":i.sense||""};let a=e7(r,s,n);if(!t.sense&&"fixed"===a.type&&1===a.synsets.length&&s.sense_keys&&(t.sense=s.sense_keys[a.synsets[0].index]),"replace"===t.type){let s="string"==typeof t.originalTerm?t.originalTerm:t.originalTerm.source;delete n[s],d({type:"add",entry:{type:"replace_term",name:r,value:n[r],originalName:s,originalValue:e[s]}})}else if(r in e){let t;let s=e[r],i=n[r];if(s.sense&&i.sense!==s.sense)t={field:"sense",new:i.sense,original:s.sense};else{let e=[];Object.keys(i.categories).forEach(t=>{i.categories[t]!==s.categories[t]&&e.push({category:t,from:s.categories[t]||0,to:i.categories[t]||0})}),Object.keys(s.categories).forEach(t=>{t in i.categories||e.push({category:t,from:s.categories[t],to:0})}),e.length?t={field:"categories",edits:e}:i.sense!==s.sense&&(t={field:"sense",new:i.sense,original:s.sense})}t&&d({type:"add",entry:{type:"edit_term",name:r,value:t}})}else d({type:"add",entry:{type:"add_term",name:r,value:n[r]}})}p({type:"collect",dictionary:n})}return m({type:"save",name:a,dict:n}),n},i.default);return(0,l.useEffect)(()=>{r.selected&&r.selected in i||(r.selected="default"),f({type:"change_dict",dict:i[r.selected]})},[r,i]),(0,n.jsx)(td.Provider,{value:u,children:(0,n.jsx)(tu.Provider,{value:d,children:(0,n.jsx)(tr.Provider,{value:i,children:(0,n.jsx)(ti.Provider,{value:m,children:(0,n.jsx)(ts.Provider,{value:a,children:(0,n.jsx)(ta.Provider,{value:g,children:(0,n.jsx)(to.Provider,{value:x,children:(0,n.jsx)(tn.Provider,{value:e=>{y(e)},children:(0,n.jsx)(tl.Provider,{value:f,children:(0,n.jsx)(tc.Provider,{value:p,children:(0,n.jsx)(th.Provider,{value:e=>{let t={...g},s=c();(function(e,t,s){let n=t.position;if(e>t.position)for(n=Math.max(0,n);n<e+1;n++)t.edits[n]&&function(e,t){switch(e.type){case"add_term":delete t[e.name];return;case"remove_term":t[e.name]=e.value;return;case"replace_term":delete t[e.name],t[e.originalName]=e.originalValue;return;case"edit_term":if("categories"===e.value.field){let s={...t[e.name]};e.value.edits.forEach(e=>{e.from?s.categories[e.category]=e.from:delete s.categories[e.category]})}else t[e.name][e.value.field]=e.value.original;return;case"add_category":Object.keys(t).forEach(s=>{let n=t[s];Object.keys(n.categories).forEach(t=>{t in e.value&&delete n.categories[t]})});return;case"remove_category":Object.keys(t).forEach(s=>{s in e.value&&(t[s].categories[e.name]=e.value[s])});return;case"rename_category":Object.keys(t).forEach(s=>{let n=t[s];e.name in n.categories&&(n.categories[e.name]&&(n.categories[e.originalName]=n.categories[e.name]),delete n.categories[e.name])});return}}(t.edits[n],s);else for(n=Math.min(t.edits.length-1,n);n>e;n--)t.edits[n]&&function(e,t){switch(e.type){case"add_term":t[e.name]=e.value;return;case"remove_term":delete t[e.name];return;case"replace_term":delete t[e.originalName],t[e.name]=e.value;return;case"edit_term":if("categories"===e.value.field){let s={...t[e.name]};e.value.edits.forEach(e=>{e.to?s.categories[e.category]=e.to:delete s.categories[e.category]})}else t[e.name][e.value.field]=e.value.new;return;case"add_category":Object.keys(t).forEach(s=>{s in e.value&&(t[s].categories[e.name]=e.value[s])});return;case"remove_category":Object.keys(e.value).forEach(s=>{let n=t[s];n&&n.categories&&e.name in n.categories&&delete n.categories[e.name]});return;case"rename_category":Object.keys(t).forEach(s=>{let n=t[s];e.originalName in n.categories&&(n.categories[e.originalName]&&(n.categories[e.name]=n.categories[e.originalName]),delete n.categories[e.originalName])});return}}(t.edits[n],s);t.position=e})(Math.min(Math.max(-1,s.position+e),s.edits.length-1),s,t),d({type:"replace",history:s}),localStorage.setItem("dict_history_"+a,JSON.stringify(s)),f({type:"history_bulk",dict:t})},children:t})})})})})})})})})})})}var tp=s(88938),ty=s(51469),tg=s(34989),tf=s(23341),tj=s(83509),tZ=s(7662),tv=s(56470),tb=s(53050),tC=s(12016),t_=s(36350),tk=s(28362);function tw(e){let{nodes:t,edges:s,options:r}=e,i=(0,l.useContext)(eN),a=(0,l.useContext)(eF),o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let e=o.current?(0,tZ.S1)(o.current,"dark",{renderer:"canvas"}):null,t=()=>e&&e.resize();return e&&e.on("click",e=>{("node"===e.dataType||"graphGL"===e.componentSubType)&&(i(e.name,!0),a({type:"add",state:{type:"term",value:e.name}}))}),window.addEventListener("resize",t),()=>{if(e){let t=e._chartsViews;t&&t.forEach(e=>{e._layouting&&(e._layouting=!1,clearTimeout(e._layoutTimeout))}),e.dispose()}window.removeEventListener("resize",t)}},[r.layout]),(0,l.useEffect)(()=>{if(o.current){let e=(0,tZ.JE)(o.current);if(e){if(r.hide_zeros&&(t=t.filter(e=>!!e.value)),t=t.map(e=>(e.label={show:e.value>=r.label_threshold},e)),s.length){let n={};t.forEach(e=>{if("string"==typeof e.category)n[e.category]=!0;else{let t="";e.category.forEach(e=>{n[e]=!0,t=e}),e.category=t}e.symbolSize=r.size_by_value?7+18*e.prop:10});let i=Object.keys(n).map(e=>({name:e}));e.setOption({legend:{align:"right",right:"right",orient:"vertical",type:"plain",pageButtonGap:10},tooltip:{confine:!0,formatter:e=>e.marker+(e.data.host?"<i>("+e.data.host+")</i> ":"")+e.name+": <strong>"+e.value.toFixed(3)+"</strong>"},backgroundColor:"#000",series:["forceAtlas2"===r.layout?{type:"graphGL",nodes:t,edges:s,categories:i,roam:!0,label:{show:!0,position:"top",color:"#fff"},lineStyle:{color:"source"},emphasis:{focus:"adjacency",lineStyle:{color:"#fff",opacity:1,width:10}}}:{type:"graph",layout:r.layout,nodes:t,edges:s,categories:i,roam:!0,label:{show:!0,position:"top"},emphasis:{focus:"adjacency",itemStyle:{opacity:1},label:{opacity:1},lineStyle:{width:10,opacity:1}},blur:{itemStyle:{opacity:.3},lineStyle:{opacity:.3},label:{opacity:.3}},autoCurveness:!0,draggable:!0,force:{repulsion:r.repulsion,gravity:r.gravity,edgeLength:r.edge_length},circular:{rotateLabel:!0},lineStyle:{color:"source"}}]},!1,"forceAtlas2"!==r.layout)}else e.clear()}}},[t,s,r]),(0,n.jsx)(en.Z,{ref:o,sx:{width:"100%",height:"100%",minHeight:"10px"}})}async function tS(e,t,s,n,r,i,a){clearTimeout(e1.comparisons);let l=Object.keys(t),o=l.length;for(let r=0;e<o&&r<100;r++,e++){let r=t[l[e]];r.processed.lookup.map.forEach((e,i)=>{let l=r.term+"."+i,o=i+"."+r.term;if(r.term!==i&&!(l in n)&&!(o in n)&&i in t){n[l]=n[o]=!0;let e=function(e,t,s){if(!t.processed)return 0;let n=e.term,r={lemma:+(n in t.processed.lookup.lemma),lemma_related:+(n in t.processed.lookup.lemma_related),lemma_synset:+(n in t.processed.lookup.lemma_synset),related:+(n in t.processed.lookup.related),related_lemma:+(n in t.processed.lookup.related_lemma),related_related:+(n in t.processed.lookup.related_related),related_synset:+(n in t.processed.lookup.related_synset),synset:+(n in t.processed.lookup.synset),synset_lemma:+(n in t.processed.lookup.synset_lemma),synset_related:+(n in t.processed.lookup.synset_related),synset_synset:+(n in t.processed.lookup.synset_synset)};return s?.35*r.lemma+.1*r.lemma_related+.001*r.lemma_synset+.25*r.related+.1*r.related_lemma+.001*r.related_related+.001*r.related_synset+.001*r.synset+.001*r.synset_lemma+.001*r.synset_related+.001*r.synset_synset:.35*r.lemma+.25*r.related+.001*r.synset}(r,t[i],a.dense);e>a.min_sim&&s.push({source:r.term,target:i,value:e,lineStyle:{width:.3+2*e,opacity:.35}})}})}r([e,o]),e<o?e1.comparisons=setTimeout(()=>tS(e,t,s,n,r,i,a),0):setTimeout(()=>{let e={},n=Object.values(t).map((t,s)=>(e[t.term]=s,{x:Math.random()*window.innerWidth,y:Math.random()*window.innerHeight,host:t.host||"",category:Object.keys(t.categories),name:t.term,prop:1,value:0,symbolSize:10,itemStyle:{opacity:1},label:{show:!0}}));s.forEach(t=>{n[e[t.source]].value+=t.value,n[e[t.target]].value+=t.value});let r=0;n.forEach(e=>{let{value:t}=e;t>r&&(r=t)}),i({edges:s,nodes:n.map(e=>(e.prop=e.value/r,e.itemStyle={opacity:.6+.4*e.prop},e))})},0)}function tE(e){let{selectedCategories:t,options:s,plotOptions:r}=e,i=(0,l.useContext)(z),a=(0,l.useContext)(ta),o=(0,l.useMemo)(()=>{let e={},t=[];return Object.keys(a).forEach(n=>{let r=e7(n,i,a,!0);"fixed"===r.type?n in e||(e[n]=!0,t.push({term:n,categories:a[n].categories,processed:r})):s.include_fuzzy&&r.matches.forEach(s=>{s in a||s in e||(e[s]=!0,t.push({host:n,term:s,categories:a[n].categories,processed:e7(s,i,{},!0)}))})}),t},[a,i,s]),[c,h]=(0,l.useState)({edges:[],nodes:[]}),[m,x]=(0,l.useState)([0,0]);return(0,l.useEffect)(()=>{let e=new Map(t.map((e,t)=>[t,e])),n={};o.forEach(t=>{let s=!1,r={};e.forEach(e=>{e in t.categories&&(s=!0,r[e]=t.categories[e])}),s&&(n[t.term]={...t,categories:r})}),tS(0,n,[],{},x,h,s)},[o,t]),m[0]<m[1]?(0,n.jsx)(en.Z,{sx:{position:"relative",width:"100%",height:"100%"},children:(0,n.jsx)(en.Z,{sx:{display:"flex",position:"absolute",top:0,right:0,bottom:0,left:0,alignItems:"center",justifyContent:"center",textAlign:"center"},children:(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(u.Z,{variant:"h5",children:"Calculating Pairwise Similarities"}),(0,n.jsx)(ei.Z,{variant:"determinate",value:m[0]/m[1]*100}),(0,n.jsx)(u.Z,{variant:"caption",children:m[0]+" / "+m[1]})]})})}):(0,n.jsx)(en.Z,{sx:{position:"relative",width:"100%",height:"100%"},children:(0,n.jsx)(tw,{nodes:c.nodes,edges:c.edges,options:r})})}(0,tj.D)([tv.N,tC.N,tk.N,t_.N,tb.N]);let tz={type:"graph",layout:"force",size_by_value:!0,hide_zeros:!1,label_threshold:0,repulsion:100,gravity:.1,edge_length:40},tN={include_fuzzy:!1,dense:!1,min_sim:.001};function tO(e,t){let s={...e};return e[t.key],s[t.key]=t.value,s}function tP(){let e=(0,l.useContext)(ta),t=(0,l.useContext)(to),[s,r]=(0,l.useReducer)(tO,tz),[i,a]=(0,l.useReducer)(tO,tN),[o,c]=(0,l.useState)([]);(0,l.useEffect)(()=>{c(o.filter(e=>t.includes(e)))},[t]);let p=t.length,y=(0,l.useMemo)(()=>{let t={};return Object.values(e).forEach(e=>{Object.keys(e.categories).forEach(e=>{e in t?t[e]++:t[e]=1})}),t},[e]);return(0,n.jsxs)(d.Z,{direction:"row",sx:{height:"100%"},children:[(0,n.jsx)(en.Z,{sx:{height:"100%",minWidth:"250px",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:(0,n.jsxs)(en.Z,{sx:{pl:1,pr:1,height:"100%"},children:[(0,n.jsxs)(en.Z,{sx:{maxHeight:"60%",overflowY:"auto"},children:[(0,n.jsx)(u.Z,{variant:"h6",children:"Terms"}),p?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.Z,{dense:!0,sx:{overflowY:"auto",maxHeight:"300px",p:0},children:t.map(e=>(0,n.jsx)(m.ZP,{disablePadding:!0,disableGutters:!0,children:(0,n.jsxs)(U.Z,{disableGutters:!0,"aria-label":"toggle category",onClick:()=>{let t=[...o],s=t.indexOf(e);-1===s?t.push(e):t.splice(s,1),c(t)},children:[(0,n.jsx)(x.Z,{sx:{minWidth:"35px"},children:(0,n.jsx)(ty.Z,{sx:{p:0},checked:o.includes(e)})}),(0,n.jsx)(X.Z,{sx:{m:0},primary:e,secondary:y[e]+" terms"})]})},e))}),(0,n.jsxs)(tg.Z,{sx:{justifyContent:"space-between"},variant:"dense",disableGutters:!0,children:[(0,n.jsxs)(d.Z,{direction:"row",children:[(0,n.jsx)(L.Z,{size:"small",sx:{minWidth:"1px"},onClick:()=>{c([...t])},children:"All"}),(0,n.jsx)(L.Z,{size:"small",sx:{minWidth:"1px"},onClick:()=>{c([])},children:"None"})]}),(0,n.jsx)(u.Z,{sx:{pr:1,whiteSpace:"nowrap"},children:o.length+" / "+p+" selected"})]})]}):(0,n.jsx)(u.Z,{textAlign:"center",children:"No Categories"}),(0,n.jsxs)(d.Z,{spacing:2,children:[(0,n.jsx)(ec.Z,{title:"Include all matches to fuzzy terms in the comparison.",placement:"right",children:(0,n.jsx)(ew.Z,{label:"Fuzzy Matches",labelPlacement:"start",control:(0,n.jsx)(eS.Z,{size:"small",checked:i.include_fuzzy,onChange:()=>a({key:"include_fuzzy",value:!i.include_fuzzy})})})}),(0,n.jsx)(ec.Z,{title:"Include second-order term relationships in similarity calculations, resulting in a denser network.",placement:"right",children:(0,n.jsx)(ew.Z,{label:"Secondary Connections",labelPlacement:"start",control:(0,n.jsx)(eS.Z,{size:"small",checked:i.dense,onChange:()=>a({key:"dense",value:!i.dense})})})}),(0,n.jsx)(ec.Z,{title:"Will consider nodes with similarity equal to or less than this as unconnected.",placement:"right",children:(0,n.jsx)(W.Z,{value:i.min_sim,type:"number",size:"small",label:"Similarity Threshold",onChange:e=>a({key:"min_sim",value:e.target.value})})})]})]}),(0,n.jsxs)(en.Z,{sx:{maxHeight:"40%",overflowY:"auto"},children:[(0,n.jsx)(u.Z,{variant:"h6",sx:{mt:2},children:"Plot Options"}),(0,n.jsxs)(d.Z,{spacing:2,children:[(0,n.jsx)(ew.Z,{label:"Hide Zeros",labelPlacement:"start",control:(0,n.jsx)(eS.Z,{size:"small",checked:s.hide_zeros,onChange:()=>r({key:"hide_zeros",value:!s.hide_zeros})})}),(0,n.jsx)(ew.Z,{label:"Size By Value",labelPlacement:"start",control:(0,n.jsx)(eS.Z,{size:"small",checked:s.size_by_value,onChange:()=>r({key:"size_by_value",value:!s.size_by_value})})}),(0,n.jsx)(ec.Z,{title:"Will not show labels for nodes with values lower than this.",placement:"right",children:(0,n.jsx)(W.Z,{value:s.label_threshold,type:"number",size:"small",label:"Label Threshold",onChange:e=>r({key:"label_threshold",value:e.target.value})})}),"graph"===s.type?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e_.Z,{fullWidth:!0,children:[(0,n.jsx)(ek.Z,{id:"graph_layout_select",children:"Layout"}),(0,n.jsxs)(el.Z,{labelId:"graph_layout_select",label:"Layout",size:"small",value:s.layout||"force",onChange:e=>{r({key:"layout",value:e.target.value})},children:[(0,n.jsx)(tf.Z,{children:"Canvas"}),(0,n.jsx)(eo.Z,{value:"none",children:"Random"}),(0,n.jsx)(eo.Z,{value:"circular",children:"Circular"}),(0,n.jsx)(eo.Z,{value:"force",children:"Force"}),(0,n.jsx)(tf.Z,{children:"WebGL"}),(0,n.jsx)(eo.Z,{value:"forceAtlas2",children:"ForceAtlas2"})]})]}),"force"===s.layout?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ec.Z,{title:"Repulsion factor between nodes.",placement:"right",children:(0,n.jsx)(W.Z,{value:s.repulsion,type:"number",size:"small",label:"Repulsion",onChange:e=>r({key:"repulsion",value:e.target.value})})}),(0,n.jsx)(ec.Z,{title:"Nodes' strength of attraction to the center.",placement:"right",children:(0,n.jsx)(W.Z,{value:s.gravity,type:"number",size:"small",label:"Gravity",onChange:e=>r({key:"gravity",value:e.target.value})})}),(0,n.jsx)(ec.Z,{title:"Base distance between nodes.",placement:"right",children:(0,n.jsx)(W.Z,{value:s.edge_length,type:"number",size:"small",label:"Edge Length",onChange:e=>r({key:"edge_length",value:e.target.value})})})]}):(0,n.jsx)(n.Fragment,{})]}):(0,n.jsx)(n.Fragment,{})]})]})]})}),(0,n.jsx)(tE,{selectedCategories:o,options:i,plotOptions:s})]})}var tF=s(9540),tT=s(90880),tM=s(76500),tA=s(71932),tI=s(35843),tD=s(41101),tW=s(14172);function tR(e){let{setName:t,setContent:s}=e,r=(0,l.useContext)(tr),i=Object.keys((0,l.useContext)(tr)),[a,o]=(0,l.useState)(!1),c=()=>o(!a);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ec.Z,{title:"select an existing dictionary to import as a copy",children:(0,n.jsx)(L.Z,{variant:"outlined",onClick:c,children:"Copy"})}),a&&(0,n.jsxs)(q.Z,{open:a,onClose:c,children:[(0,n.jsx)(J.Z,{children:"Copy Dictionary"}),(0,n.jsx)(T.Z,{"aria-label":"close export menu",onClick:c,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,n.jsx)(F.Z,{})}),(0,n.jsx)(K.Z,{sx:{p:0},children:(0,n.jsx)(h.Z,{sx:{p:0,pb:2},children:i.map(e=>(0,n.jsx)(m.ZP,{sx:{p:0},children:(0,n.jsx)(U.Z,{onClick:()=>{t(e+" Copy" in r?e+" Copy"+(1e4*Math.random()>>0):e+" Copy"),s(JSON.stringify(r[e],void 0,2)),c()},children:e})},e))})})]})]})}let tL=(0,tI.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),tq=/\t/,tJ=/\s\s/,tK=/^\s+|\s+$/g,tH=/^["\s]+|["\s]+$/g,tB=/\s{2,}|\t+/g,t$=/[[({]/,tG=/[\])}]/,tY=/([\[\]\(\)?^$.+])/;function tV(e,t,s,n){return{added:Date.now(),type:n&&function(e){if(!tY.test(e))return!1;let t=t$.test(e),s=tG.test(e);return t&&s||!t&&!s}(e)?"regex":"fixed",categories:t,sense:s||""}}function tU(){let e=(0,tD.Z)(),t=(0,l.useContext)(ti),[s,r]=(0,l.useState)(""),[i,a]=(0,l.useState)(!1),o=()=>a(!i),[c,u]=(0,l.useState)(!1),[h,m]=(0,l.useState)(""),x=()=>{r(""),m("")},p=()=>{s&&(t({type:"add",name:s,dict:function(e,t){let s={};if(e)try{if("%"===e[0]){let n=e.split(y),r={},i=n.length;if(i>1){let e=1;for(e=1;e<i;e++){let t=n[e].replace(tK,"");if("%"===t)break;let s=t.split(tB);s.length>1&&s[1]&&(r[s[0]]=s[1])}for(e++;e<i;e++){let i=n[e].replace(tK,"").split(tB);if(i.length>1){let e=i.splice(0,1)[0].toLowerCase();if(e){let n={};i.forEach(e=>{e in r&&(n[r[e]]=1)});let[a,l]=e.split("@");s[a]=tV(a,n,l,t)}}}}}else if("{"===e[0]){let n=JSON.parse(e),r=Object.keys(n);if(r.length&&"type"in n[r[0]]&&"string"==typeof n[r[0]].type)return n;r.forEach(e=>{if(e){let r=n[e];Array.isArray(r)?r.forEach(n=>{if(n){if(n in s)s[n].categories[e]=1;else{let[r,i]=n.toLowerCase().split("@");s[n]=tV(r,{[e]:1},i,t)}}}):Object.keys(r).forEach(n=>{if(n){if(n in s)s[n].categories[e]=r[n];else{let[i,a]=n.toLowerCase().split("@");s[n]=tV(i,{[e]:r[i]},a,t)}}})}})}else{let n=e.split(y),r=tq.test(n[0])?"	":tJ.test(n[0])?"  ":",",i=n.splice(0,1)[0].split(r).map(e=>e.replace(tH,""));i.splice(0,1);let a="term_sense"===i[0];n.forEach(e=>{let n=e.split(r),l=n.splice(0,1)[0].toLowerCase().replace(tH,"");if(l){let e="",r={};n.forEach((t,s)=>{if(t&&i[s]){let n=+t;!e&&(a&&0===s||isNaN(n))?e=t:r[i[s]]=+t}}),s[l]=tV(l,r,e,t)}})}}catch(e){}return s}(h,c)}),x(),o())};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L.Z,{variant:"outlined",onClick:o,children:"New"}),(0,n.jsxs)(q.Z,{open:i,onClose:o,onDrop:e=>{if(e.preventDefault(),e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files.length){let t=e.dataTransfer.files[0],n=new FileReader;n.onload=()=>{s||r(E(t.name)),m(n.result)},n.readAsText(t)}},children:[(0,n.jsx)(J.Z,{children:"Add Dictionary"}),(0,n.jsx)(T.Z,{"aria-label":"close import menu",onClick:o,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,n.jsx)(F.Z,{})}),(0,n.jsx)(K.Z,{sx:{p:1},children:(0,n.jsxs)(d.Z,{spacing:1,children:[(0,n.jsx)(W.Z,{size:"small",label:"Name",value:s,onKeyDown:e=>{s&&"Enter"===e.code&&p()},onChange:e=>{r(e.target.value)}}),(0,n.jsxs)(e_.Z,{children:[(0,n.jsx)(tW.Z,{sx:{fontSize:".8em"},htmlFor:"import_content",children:"Import Content"}),(0,n.jsx)("textarea",{id:"import_content",style:{backgroundColor:e.palette.background.default,color:e.palette.text.primary,whiteSpace:h?"pre":"normal",minWidth:"30em",minHeight:"20em"},value:h,onChange:e=>{m(e.target.value)},placeholder:"drag and drop a file, or enter content directly; see export menu for format examples"})]}),(0,n.jsx)(ec.Z,{title:"Attempt to convert terms to regular expressions if they contain special RegEx characters.",children:(0,n.jsx)(ew.Z,{label:"Detect RegEx",labelPlacement:"start",control:(0,n.jsx)(eS.Z,{checked:c,onChange:()=>u(!c)})})})]})}),(0,n.jsxs)(H.Z,{sx:{justifyContent:"space-between"},children:[(0,n.jsxs)(d.Z,{direction:"row",spacing:1,children:[(0,n.jsx)(tR,{setName:r,setContent:m}),(0,n.jsx)(ec.Z,{title:"select a file to import a dictionary from",children:(0,n.jsxs)(L.Z,{variant:"outlined",component:"label",children:["File",(0,n.jsx)(tL,{type:"file",onChange:e=>{if(e.target.files&&e.target.files.length){let t=e.target.files[0],n=new FileReader;n.onload=()=>{s||r(E(t.name)),m(n.result)},n.readAsText(t)}}})]})}),(0,n.jsx)(ec.Z,{title:"clear current content",children:(0,n.jsx)(L.Z,{onClick:x,children:"clear"})})]}),(0,n.jsx)(L.Z,{variant:"contained",onClick:p,children:"Add"})]})]})]})}function tX(){let e=(0,tD.Z)(),t=(0,l.useContext)(ts),s=(0,l.useContext)(tr)[t],[r,i]=(0,l.useState)(!1),a=()=>i(!r),[o,c]=(0,l.useState)("dic"),[h,m]=(0,l.useState)("csv"),[x,p]=(0,l.useState)(t),[y,g]=(0,l.useState)("unweighted"),[f,j]=(0,l.useState)(!1),Z=(0,l.useMemo)(()=>r?function(e,t,s,n,r){switch(t){case"tabular":let i=function(e){switch(e){case"csv":return",";case"tsv":return"	";default:return"  "}}(s),a=Object.keys(e),l=new Set;a.forEach(t=>{let s=e[t].categories;s&&Object.keys(s).forEach(e=>l.add(e))});let o=Array.from(l),c=new Map(o.map((e,t)=>[t,e]));return'"term"'+i+'"'+(r?'term_sense"'+i+'"':"")+o.join('"'+i+'"')+'"\n'+a.map(t=>{let s=e[t].categories,n='"'+t+'"';return r&&(n+=i+e[t].sense),c.forEach(e=>{n+=i+(e in s?s[e]:"")}),n}).join("\n");case"dic":let d={},u=0,h="";return Object.keys(e).forEach(t=>{let s=e[t].categories;if(s){let n=[t];r&&e[t].sense&&(n[0]+="@"+e[t].sense),Object.keys(s).forEach(e=>{e in d||(d[e]=++u),n.push(d[e])}),h+="\n"+n.join("	")}}),"%\n"+Object.keys(d).map(e=>d[e]+"	"+e).join("\n")+"\n%"+h;case"json":if("full"===n)return JSON.stringify(e,void 0,2);let m={};if(Object.keys(e).forEach(t=>{let s=e[t].categories;s&&(r&&e[t].sense&&(t+="@"+e[t].sense),Object.keys(s).forEach(e=>{e in m||(m[e]={}),m[e][t]=s[e]}))}),"weighted"===n)return JSON.stringify(m,void 0,2);let x={};return Object.keys(m).forEach(e=>{x[e]=Object.keys(m[e])}),JSON.stringify(x,void 0,2);default:return""}}(s,o,h,y,f):"",[r,s,o,h,y,f]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L.Z,{variant:"outlined",onClick:a,children:"Export"}),r&&(0,n.jsxs)(q.Z,{open:r,onClose:a,children:[(0,n.jsx)(J.Z,{children:"Export Dictionary"}),(0,n.jsx)(T.Z,{"aria-label":"close export menu",onClick:a,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,n.jsx)(F.Z,{})}),(0,n.jsx)(K.Z,{sx:{p:1},children:(0,n.jsxs)(d.Z,{spacing:1,children:[(0,n.jsx)(W.Z,{size:"small",label:"Filename",value:x,onChange:e=>{p(e.target.value)}}),(0,n.jsxs)(e_.Z,{children:[(0,n.jsx)(tW.Z,{sx:{fontSize:".8em"},htmlFor:"export_content",children:"Export Content"}),(0,n.jsx)("textarea",{id:"export_content",style:{backgroundColor:e.palette.background.default,color:e.palette.text.primary,whiteSpace:"pre",minWidth:"35em",minHeight:"20em"},value:Z,onChange:()=>{}})]})]})}),(0,n.jsxs)(H.Z,{sx:{justifyContent:"space-between"},children:[(0,n.jsxs)(d.Z,{direction:"row",spacing:1,children:["json"!==o||"full"!==y?(0,n.jsx)(ew.Z,{sx:{transform:"translate(0, -10px)"},control:(0,n.jsx)(eS.Z,{size:"small",checked:f,onChange:()=>j(!f)}),label:(0,n.jsx)(u.Z,{variant:"caption",children:"Senses"}),labelPlacement:"top"}):(0,n.jsx)(n.Fragment,{}),(0,n.jsxs)(e_.Z,{children:[(0,n.jsx)(ek.Z,{id:"export_format",children:"Format"}),(0,n.jsxs)(el.Z,{labelId:"export_format",label:"Format",size:"small",value:o,onChange:e=>{c(e.target.value)},children:[(0,n.jsx)(eo.Z,{value:"dic",children:"DIC"}),(0,n.jsx)(eo.Z,{value:"json",children:"JSON"}),(0,n.jsx)(eo.Z,{value:"tabular",children:"Tabular"})]})]}),"tabular"===o?(0,n.jsxs)(e_.Z,{children:[(0,n.jsx)(ek.Z,{id:"export_separator",children:"Type"}),(0,n.jsxs)(el.Z,{labelId:"export_separator",label:"Type",size:"small",value:h,onChange:e=>{m(e.target.value)},children:[(0,n.jsx)(eo.Z,{value:"csv",children:"CSV"}),(0,n.jsx)(eo.Z,{value:"tsv",children:"TSV"}),(0,n.jsx)(eo.Z,{value:"dat",children:"DAT"})]})]}):(0,n.jsx)(n.Fragment,{})," ","json"===o?(0,n.jsxs)(e_.Z,{children:[(0,n.jsx)(ek.Z,{id:"export_json_type",children:"Type"}),(0,n.jsxs)(el.Z,{labelId:"export_json_type",label:"Type",size:"small",value:y,onChange:e=>{g(e.target.value)},children:[(0,n.jsx)(eo.Z,{value:"weighted",children:"Weighted"}),(0,n.jsx)(eo.Z,{value:"unweighted",children:"Unweighted"}),(0,n.jsx)(eo.Z,{value:"full",children:"Full"})]})]}):(0,n.jsx)(n.Fragment,{})]}),(0,n.jsx)(L.Z,{variant:"contained",onClick:()=>{if(x&&Z){let e=document.createElement("a");e.setAttribute("href",URL.createObjectURL(new Blob([Z],{type:"text/plain"}))),e.setAttribute("download",x+"."+("tabular"===o?h:o)),document.body.appendChild(e),e.click(),document.body.removeChild(e)}},children:"Download"})]})]})]})}function tQ(e){let{category:t,onClose:s}=e,[r,i]=(0,l.useState)(!1),a=(0,l.useContext)(to),o=(0,l.useContext)(z),c=(0,l.useContext)(ta),[h,m]=(0,l.useState)(t),[x,p]=(0,l.useState)(t);(0,l.useEffect)(()=>{p(t)},[t,p]),(0,l.useEffect)(()=>{m(x)},[x,m]);let y=(0,l.useContext)(tl),g=(0,l.useCallback)((e,s)=>{let{field:n,row:r}=s,{processed:i,dictEntry:a}=r;if(n){let s={...a.categories};t in s&&!e?delete s[t]:e&&(s[t]=e),y({type:"update",term:i.term,term_type:i.term_type,categories:s})}},[y,t]),f=(0,l.useMemo)(()=>new Map(Object.keys(c).map((e,t)=>[t,e])),[c]),j=(0,l.useMemo)(()=>{let e={};return f.forEach(s=>{let{categories:n}=c[s];t in n&&(e[s]=n[t])}),e},[c,f,t]),Z=(0,l.useMemo)(()=>{let e=[];return f.forEach(t=>{(r||t in j)&&e.push({id:t,weight:j[t]||"",dictEntry:c[t],processed:e7(t,o,c)})}),e},[o,c,f,r,j]);return t&&a.includes(t)?(0,n.jsxs)(q.Z,{open:!!t,onClose:s,children:[(0,n.jsx)(J.Z,{children:"Category Editor"}),(0,n.jsx)(T.Z,{"aria-label":"close category editor",onClick:s,sx:{position:"absolute",right:8,top:12},className:"close-button",children:(0,n.jsx)(F.Z,{})}),(0,n.jsx)(K.Z,{sx:{p:1,minWidth:"300px",height:"500px"},children:(0,n.jsxs)(d.Z,{sx:{height:"100%"},children:[(0,n.jsxs)(d.Z,{direction:"row",children:[(0,n.jsx)(W.Z,{label:"Name",fullWidth:!0,value:h,onChange:e=>m(e.target.value),size:"small"}),h!==t?(0,n.jsx)(L.Z,{variant:"contained",onClick:()=>{y({type:"rename_category",name:t,newName:h})},children:"Rename"}):(0,n.jsx)(n.Fragment,{})]}),(0,n.jsxs)(d.Z,{direction:"column",spacing:1,sx:{mt:2,height:"100%"},children:[(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Term Weights"}),(0,n.jsx)(ew.Z,{control:(0,n.jsx)(eS.Z,{size:"small",checked:r,onChange:()=>i(!r)}),label:(0,n.jsx)(u.Z,{variant:"caption",children:"Show Empty"}),labelPlacement:"start"}),(0,n.jsx)(eE._$,{className:"datagrid-vertical",rows:Z,columns:[{field:"id",headerName:"Term",width:170},{field:"weight",headerName:"Weight",width:95,editable:!0,hideable:!1,valueParser:(e,t)=>{let s=+e||"";return t&&g(s,t),s}}],disableRowSelectionOnClick:!0,disableDensitySelector:!0,disableColumnMenu:!0,pageSizeOptions:[100],density:"compact",slots:{toolbar:e0.T},onCellKeyDown:(e,t)=>{("Delete"===t.key||"Backspace"===t.key)&&g(0,e)}})]})]})})]}):(0,n.jsx)(n.Fragment,{})}function t0(){let[e,t]=(0,l.useState)(!1),s=()=>t(!e),[r,i]=(0,l.useState)(""),a=(0,l.useContext)(tr),o=(0,l.useContext)(ti),c=(0,l.useContext)(ts),x=Object.keys(a),p=(0,l.useContext)(to),y=(0,l.useContext)(tc),g=(0,l.useContext)(tl),[f,j]=(0,l.useState)(""),Z=()=>{f&&-1===p.indexOf(f)&&(y({type:"add",cat:f}),j(""))},v=(0,l.useMemo)(()=>p.map(e=>(0,n.jsx)(m.ZP,{disablePadding:!0,disableGutters:!0,secondaryAction:(0,n.jsx)(T.Z,{"aria-label":"delete category",sx:{opacity:.5},onClick:()=>{g({type:"remove_category",name:e}),y({type:"remove",cat:e})},children:(0,n.jsx)(ea.Z,{})}),children:(0,n.jsx)(U.Z,{dense:!0,onClick:()=>i(e),children:(0,n.jsx)(X.Z,{primary:e})})},e)),[p,g,y]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(L.Z,{variant:"text",sx:{fontWeight:"bold"},onClick:s,children:c}),(0,n.jsx)(M.ZP,{anchor:"left",open:e,onClose:s,children:(0,n.jsxs)(A.Z,{sx:{height:"100%",width:"20em",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[(0,n.jsx)(I.Z,{title:(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Dictionary Menu"}),action:(0,n.jsx)(T.Z,{onClick:s,"aria-label":"close dictionary menu",className:"close-button",children:(0,n.jsx)(F.Z,{})})}),(0,n.jsxs)(d.Z,{direction:"row",sx:{mb:2},children:[(0,n.jsxs)(e_.Z,{fullWidth:!0,children:[(0,n.jsx)(ek.Z,{id:"dictionary_select",children:"Current"}),(0,n.jsx)(el.Z,{labelId:"dictionary_select",label:"Current",size:"small",value:c,onChange:e=>{o({type:"set",name:e.target.value,dict:a[e.target.value]})},children:x.map(e=>(0,n.jsx)(eo.Z,{value:e,children:e},e))})]}),(0,n.jsx)(tU,{})]}),(0,n.jsx)(D.Z,{sx:{alignContent:"left",mb:"auto",pt:0,pb:1,height:"100%",overflow:"hidden"},children:(0,n.jsxs)(d.Z,{spacing:1,sx:{height:"100%",overflowY:"auto"},children:[(0,n.jsxs)(A.Z,{elevation:5,sx:{height:"40%",minHeight:"300px",display:"flex",flexDirection:"column"},children:[(0,n.jsx)(I.Z,{title:(0,n.jsx)(u.Z,{fontWeight:"bold",children:"Categories"}),sx:{pb:0}}),(0,n.jsx)(D.Z,{sx:{p:0,mb:"auto",overflowY:"auto"},children:(0,n.jsx)(h.Z,{dense:!0,children:v})}),(0,n.jsx)(R.Z,{children:(0,n.jsxs)(d.Z,{direction:"row",children:[(0,n.jsx)(W.Z,{label:"New Category Name",size:"small",value:f,onKeyDown:e=>{"Enter"===e.code&&Z()},onChange:e=>{j(e.target.value)}}),(0,n.jsx)(L.Z,{onClick:Z,children:"Add"})]})})]}),(0,n.jsx)(es,{})]})}),(0,n.jsx)(R.Z,{children:(0,n.jsxs)(d.Z,{direction:"column",sx:{width:"100%"},spacing:1,children:[(0,n.jsx)(tX,{}),(0,n.jsx)(B,{label:"Delete",message:"Delete the "+c+" dictionary?",onConfirm:()=>{o({type:"delete",name:c})}})]})})]})}),(0,n.jsx)(tQ,{category:r,onClose:()=>i("")})]})}function t1(e){let{terms:t,exists:s,asTable:r,setAsTable:i,add:a}=e,[o,c]=(0,l.useState)(""),[u,h]=(0,l.useState)(!1),[x,p]=(0,l.useState)([]),[y,g]=(0,l.useState)(!1),Z=(0,l.useContext)(eF),{collapsedTerms:v}=(0,l.useContext)(z),C=e=>{let t=e?"string"==typeof e?e:"innerText"in e.target?e.target.innerText:o:o;if(t&&!s(t)){if(y){let e=t;try{e=new RegExp(e)}catch(e){}a(e,"regex")}else a(t,"fixed");p([]),c("")}},_=e=>{let t=e.target;if(t&&"value"in t){let e=t.value.toLowerCase();h(s(e)),c(e)}};return(0,n.jsx)(tM.Z,{component:"nav",children:(0,n.jsxs)(tg.Z,{variant:"dense",sx:{justifyContent:"space-between"},disableGutters:!0,children:[(0,n.jsx)(t0,{}),(0,n.jsxs)(d.Z,{direction:"row",sx:{width:"calc(min(500px, 50%))"},spacing:1,children:[(0,n.jsx)(tA.Z,{options:x,value:o,onKeyUp:e=>{let s="value"in e.target?e.target.value:"";if("Enter"===e.code&&(!s||s===o))return C(o);if(s!==o&&_(e),t){let e=[];if(o&&v){let t;try{t=RegExp(y?w(o):f.test(o)?b(o):";"+o+"[^;]*;","g")}catch(e){t=RegExp(";"+o.replace(j,"\\%&")+";","g")}e8("",t,v,e,100)}p(e)}},onChange:_,renderOption:(e,t)=>(0,l.createElement)(m.ZP,{...e,key:t,onClick:C},t),renderInput:e=>(0,n.jsx)(W.Z,{...e,size:"small",placeholder:"Term to add",value:o,onChange:_,error:u}),filterOptions:e=>e,selectOnFocus:!0,clearOnBlur:!0,clearOnEscape:!0,handleHomeEndKeys:!0,fullWidth:!0,freeSolo:!0}),(0,n.jsx)(ec.Z,{title:"regular expression characters are "+(y?"active":"escaped"),children:(0,n.jsx)(T.Z,{"aria-label":"toggle regular expression",onClick:()=>g(!y),children:y?(0,n.jsx)(tF.Z,{}):(0,n.jsx)(tT.Z,{})})}),(0,n.jsx)(L.Z,{variant:"outlined",disabled:!o,onClick:()=>{o&&Z({type:"add",state:{type:"term",value:o}})},children:"View"}),(0,n.jsx)(L.Z,{variant:"contained",onClick:()=>C(),disabled:!o||u,children:"Add"})]}),(0,n.jsxs)(d.Z,{direction:"row",children:[(0,n.jsx)(L.Z,{variant:"outlined",sx:{width:100},onClick:()=>i(!r),children:r?"Analyze":"Edit"}),(0,n.jsx)(V,{})]})]})})}let t2=/^category_/;function t3(){let[e,t]=(0,l.useState)(!0),s=(0,l.useContext)(ta),r=(0,l.useContext)(to),{terms:i}=(0,l.useContext)(z),a=(0,l.useContext)(tl),o=(0,l.useCallback)((e,t)=>{let{field:s,row:n}=t,{processed:r,dictEntry:i}=n;if(s&&("from_term_editor"===s||s.startsWith("category_"))){let t={...i.categories},l="from_term_editor"===s?n.id:s.replace(t2,"");l in t&&!e?delete t[l]:e&&(t[l]=e),a({type:"update",term:r.term,term_type:r.term_type,categories:t})}},[a]),c=(0,l.useContext)(ez),d=(0,l.useContext)(eP),u=c in s,h=d.length?$:0;return(0,n.jsxs)(tp.Z,{children:[(0,n.jsx)(t1,{terms:i,exists:e=>e in s,asTable:e,setAsTable:t,add:(e,t)=>{a({type:"add",term:e,term_type:t})}}),(0,n.jsxs)(en.Z,{sx:{position:"absolute",top:0,left:0,bottom:0,right:u?G:0,mt:"3em",mb:h},children:[e?(0,n.jsx)(e3,{editFromEvent:o}):(0,n.jsx)(tP,{}),u?(0,n.jsx)(eO,{categories:r,editor:o}):(0,n.jsx)(n.Fragment,{}),(0,n.jsx)(eA,{})]})]})}let t5=(0,r.Z)({palette:{mode:"dark",primary:{main:"#b393d3"},success:{main:"#4986cb"},error:{main:"#e0561c"}}}),t4=(e,t)=>{switch("reset"!==t.type&&e.length||setTimeout(()=>window.dispatchEvent(new Event("resize")),0),t.type){case"add":return e.length&&e[0].value===t.state.value?[...e]:[t.state,...e];case"back":return[...e].splice(1,e.length);default:return[]}};function t8(){let[e,t]=(0,l.useReducer)(t4,[]),[s,r]=(0,l.useState)("");return(0,n.jsx)(l.StrictMode,{children:(0,n.jsxs)(i.Z,{theme:t5,children:[(0,n.jsx)(a.ZP,{}),(0,n.jsx)(O,{children:(0,n.jsx)(tx,{children:(0,n.jsx)(eP.Provider,{value:e,children:(0,n.jsx)(eF.Provider,{value:t,children:(0,n.jsx)(ez.Provider,{value:s,children:(0,n.jsx)(eN.Provider,{value:(e,t)=>{(s||t)&&e||setTimeout(()=>window.dispatchEvent(new Event("resize")),0),r(e)},children:(0,n.jsx)(t3,{})})})})})})})]})})}}},function(e){e.O(0,[425,971,938,744],function(){return e(e.s=46919)}),_N_E=e.O()}]);